<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveDashMatcher - AI-Powered Matchmaking</title>
    
    <!-- Meta Tags for SEO and Social Sharing -->
    <meta name="description" content="Find your perfect match through AI-powered 29-dimension compatibility analysis. Join LoveDashMatcher for meaningful, lasting connections.">
    <meta name="keywords" content="dating, matchmaking, AI dating, compatibility, relationships, love, online dating">
    <meta name="author" content="LoveDashMatcher">
    
    <!-- Open Graph Meta Tags (Facebook, LinkedIn) -->
    <meta property="og:title" content="LoveDashMatcher - AI-Powered Matchmaking">
    <meta property="og:description" content="Find your perfect match through AI-powered 29-dimension compatibility analysis.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://rse-api.com">
    <meta property="og:image" content="https://rse-api.com/og-image.jpg">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="LoveDashMatcher - AI-Powered Matchmaking">
    <meta name="twitter:description" content="Find your perfect match through AI-powered 29-dimension compatibility analysis.">
    <meta name="twitter:image" content="https://rse-api.com/twitter-image.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî∑</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        /* Navigation Bar */
        nav {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: none;
        }
        
        nav.active {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-brand {
            font-size: 1.3rem;
            font-weight: bold;
            color: #764ba2;
        }
        
        .nav-links {
            display: flex;
            gap: 25px;
            align-items: center;
        }
        
        .nav-link {
            color: #495057;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.2s;
            position: relative;
        }
        
        .nav-link:hover {
            background: #f8f9fa;
            color: #764ba2;
        }
        
        .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .nav-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: #dc3545;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Landing Page */
        .landing-page {
            display: block;
        }
        
        .hero {
            background: white;
            border-radius: 15px;
            padding: 60px 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .hero h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }
        
        .hero .tagline {
            font-size: 1.3rem;
            color: #6c757d;
            margin-bottom: 30px;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102,126,234,0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #764ba2;
            padding: 15px 40px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            border: 2px solid #764ba2;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .btn-secondary:hover {
            background: #764ba2;
            color: white;
        }
        
        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        /* How It Works Section */
        .how-it-works {
            background: white;
            border-radius: 15px;
            padding: 50px 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .how-it-works h2 {
            text-align: center;
            font-size: 2.2rem;
            color: #764ba2;
            margin-bottom: 40px;
        }
        
        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }
        
        .step {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 10px;
            position: relative;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        .step h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .step p {
            color: #6c757d;
            line-height: 1.6;
        }
        
        /* About Section */
        .about-section {
            background: white;
            border-radius: 15px;
            padding: 50px 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .about-section h2 {
            text-align: center;
            font-size: 2.2rem;
            color: #764ba2;
            margin-bottom: 40px;
        }
        
        .about-content {
            display: grid;
            gap: 25px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .about-box {
            background: linear-gradient(135deg, #667eea05 0%, #764ba205 100%);
            padding: 30px;
            border-radius: 12px;
            border-left: 4px solid #764ba2;
        }
        
        .about-box h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .about-box p {
            color: #2c3e50;
            line-height: 1.8;
            font-size: 1.05rem;
        }
        
        .about-box ol {
            padding-left: 25px;
        }
        
        .about-box ol li {
            margin-bottom: 10px;
        }
        
        /* Privacy & Terms Views */
        .privacy-view, .terms-view {
            display: none;
        }
        
        .policy-container {
            background: white;
            border-radius: 15px;
            padding: 50px 40px;
            max-width: 900px;
            margin: 20px auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .policy-container h1 {
            color: #764ba2;
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .policy-container .last-updated {
            color: #6c757d;
            font-style: italic;
            margin-bottom: 30px;
        }
        
        .policy-container h2 {
            color: #764ba2;
            font-size: 1.8rem;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .policy-container p, .policy-container li {
            color: #2c3e50;
            line-height: 1.8;
            font-size: 1.05rem;
            margin-bottom: 15px;
        }
        
        .policy-container ul, .policy-container ol {
            padding-left: 30px;
            margin-bottom: 20px;
        }
        
        .policy-container strong {
            color: #764ba2;
        }
        
        /* Photo Upload Section */
        .photo-upload-section {
            margin: 25px 0;
            padding: 25px;
            background: linear-gradient(135deg, #667eea05 0%, #764ba205 100%);
            border-radius: 12px;
            border-left: 4px solid #764ba2;
        }
        
        .photo-upload-section h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .photo-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-item-empty {
            border: 2px dashed #ccc;
            color: #999;
            font-size: 2rem;
        }
        
        .photo-delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .photo-delete-btn:hover {
            background: #dc3545;
            transform: scale(1.1);
        }
        
        .photo-upload-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .photo-upload-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
        }
        
        .photo-upload-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .photo-upload-note {
            color: #6c757d;
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: center;
        }
        
        /* Chat View */
        .chat-view {
            display: none;
        }
        
        .chat-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            height: calc(100vh - 150px);
        }
        
        .chat-main {
            background: white;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-header h3 {
            font-size: 1.3rem;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 12px;
            max-width: 75%;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .message.ai {
            background: white;
            color: #333;
            border: 1px solid #e9ecef;
            border-bottom-left-radius: 4px;
        }
        
        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 5px;
        }
        
        .chat-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
        }
        
        .chat-input-area input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            transition: border 0.2s;
        }
        
        .chat-input-area input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .chat-input-area button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
            min-width: 100px;
        }
        
        .chat-input-area button:hover:not(:disabled) {
            transform: scale(1.05);
        }
        
        .chat-input-area button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            vertical-align: middle;
            margin-right: 6px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            padding: 16px 24px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInUp 0.3s ease, fadeOut 0.3s ease 2.7s;
            z-index: 10000;
            max-width: 400px;
        }
        
        @keyframes slideInUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateY(20px);
            }
        }
        
        .toast.success {
            border-left: 4px solid #28a745;
        }
        
        .toast.error {
            border-left: 4px solid #dc3545;
        }
        
        .toast.info {
            border-left: 4px solid #17a2b8;
        }
        
        .toast-icon {
            font-size: 1.5rem;
        }
        
        .toast-message {
            flex: 1;
            color: #333;
            font-weight: 500;
        }
        
        .toast-close {
            cursor: pointer;
            color: #999;
            font-size: 1.2rem;
            padding: 0 4px;
        }
        
        .toast-close:hover {
            color: #333;
        }
        
        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 18px;
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            max-width: 75px;
            margin-bottom: 15px;
            border-bottom-left-radius: 4px;
        }
        
        .typing-indicator span {
            width: 8px;
            height: 8px;
            background: #764ba2;
            border-radius: 50%;
            animation: typingBounce 1.4s infinite ease-in-out;
        }
        
        .typing-indicator span:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes typingBounce {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        /* Chat Sidebar */
        .chat-sidebar {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .json-viewer {
            flex: 1;
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            overflow-y: auto;
            max-height: calc(100vh - 300px);
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
        }
        
        .sidebar-title {
            font-weight: 600;
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .dimension-progress {
            margin-bottom: 15px;
        }
        
        .dimension-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .dimension-item.completed {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-left: 3px solid #764ba2;
        }
        
        .dimension-item.active {
            background: linear-gradient(135deg, #FFD70015 0%, #FFA50015 100%);
            border-left: 3px solid #FFA500;
        }
        
        .dimension-status {
            font-size: 1.2rem;
        }
        
        /* Matches View */
        .matches-view {
            display: none;
        }
        
        .matches-header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .matches-header h2 {
            font-size: 2rem;
            color: #764ba2;
            margin-bottom: 10px;
        }
        
        .match-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .match-score {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .compatibility-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }
        
        .match-info {
            margin-bottom: 15px;
        }
        
        .match-info h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .shared-dimensions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }
        
        .dimension-tag {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            color: #764ba2;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .match-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .match-actions button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-reject {
            background: #dc3545;
            color: white;
        }
        
        .btn-reject:hover {
            background: #c82333;
        }
        
        /* Match Chat */
        .match-chat-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .match-chat-messages {
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .match-message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 12px;
            max-width: 75%;
            animation: slideIn 0.3s ease;
        }
        
        .match-message.sent {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .match-message.received {
            background: white;
            color: #333;
            border: 1px solid #e9ecef;
            border-bottom-left-radius: 4px;
        }
        
        .match-chat-input-area {
            display: flex;
            gap: 10px;
        }
        
        .match-chat-input-area input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            transition: border 0.2s;
        }
        
        .match-chat-input-area input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .match-chat-input-area button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .match-chat-input-area button:hover {
            transform: scale(1.05);
        }
        
        /* Profile View */
        .profile-view {
            display: none;
        }
        
        .profile-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .profile-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .profile-header {
            margin-bottom: 30px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 20px;
        }
        
        .profile-header h2 {
            color: #764ba2;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .profile-stat {
            background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .profile-stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #764ba2;
        }
        
        .profile-stat-label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 5px;
        }
        
        .dimensions-summary {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .dimension-chip {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            text-align: center;
            font-weight: 500;
        }
        
        .json-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .json-panel h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .json-scroll {
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            overflow-y: auto;
            max-height: 600px;
            white-space: pre-wrap;
            word-break: break-word;
            flex: 1;
        }
        
        /* Auth Section */
        .auth-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 20px auto;
            max-width: 900px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .auth-forms {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .auth-box {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
        }
        
        .auth-box h2 {
            color: #764ba2;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #495057;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .auth-box button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .auth-box button:hover {
            transform: translateY(-2px);
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            border: 1px solid #f5c6cb;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            border: 1px solid #c3e6cb;
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
            border-radius: 10px;
        }
        
        .toggle-label {
            font-weight: 600;
            font-size: 1.1rem;
            color: #333;
        }
        
        .status-text {
            font-weight: 700;
            font-size: 1.1rem;
            min-width: 80px;
            text-align: left;
        }
        
        .status-text.active {
            color: #28a745;
        }
        
        .status-text.inactive {
            color: #dc3545;
        }
        
        /* Footer */
        footer {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 40px 20px 20px;
            margin-top: 60px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 30px;
        }
        
        .footer-section h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .footer-section p, .footer-section a {
            color: #6c757d;
            text-decoration: none;
            line-height: 1.8;
            font-size: 0.95rem;
            display: block;
        }
        
        .footer-section a:hover {
            color: #764ba2;
        }
        
        .footer-bottom {
            max-width: 1200px;
            margin: 0 auto;
            padding-top: 20px;
            border-top: 1px solid rgba(0,0,0,0.1);
            text-align: center;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero {
                padding: 40px 25px;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero .tagline {
                font-size: 1.1rem;
            }
            
            .cta-buttons {
                flex-direction: column;
            }
            
            .btn-primary, .btn-secondary {
                width: 100%;
            }
            
            .auth-forms {
                grid-template-columns: 1fr;
            }
            
            .chat-container {
                grid-template-columns: 1fr;
                height: calc(100vh - 100px);
            }
            
            .chat-sidebar {
                display: none;
            }
            
            .chat-input-area input {
                font-size: 16px; /* Prevents zoom on iOS */
            }
            
            .profile-layout {
                grid-template-columns: 1fr;
            }
            
            .json-panel {
                max-height: 400px;
            }
            
            .dimensions-grid {
                grid-template-columns: 1fr;
            }
            
            .steps {
                grid-template-columns: 1fr;
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
            }
            
            .dimensions-summary {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .nav-links {
                gap: 10px;
                flex-wrap: wrap;
            }
            
            .nav-link {
                font-size: 0.9rem;
                padding: 6px 12px;
            }
            
            .toast {
                right: 15px;
                left: 15px;
                bottom: 15px;
                max-width: none;
            }
            
            footer {
                padding: 30px 15px 15px;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                gap: 25px;
            }
            
            .match-actions {
                flex-direction: column;
            }
            
            .match-actions button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar (Hidden until logged in) -->
    <nav id="mainNav">
        <div class="nav-brand">üî∑ LoveDashMatcher</div>
        <div class="nav-links">
            <a href="#" class="nav-link" onclick="showView('landing')">Home</a>
            <a href="#" class="nav-link" onclick="showView('chat')">Build Profile</a>
            <a href="#" class="nav-link" onclick="showView('profile')">
                Connect with Match
                <span class="nav-badge hidden" id="matchBadge">1</span>
            </a>
            <a href="#" class="nav-link" onclick="logout()">Logout</a>
        </div>
    </nav>

    <div class="container">
        <!-- Landing Page -->
        <div id="landingPage" class="landing-page">
            <!-- Hero Section -->
            <div class="hero">
                <h1>üî∑ LoveDashMatcher</h1>
                <p class="tagline">One Perfect Match at a Time ‚Ä¢ Deep Compatibility ‚Ä¢ Real Connections</p>
                
                <div style="max-width: 700px; margin: 0 auto 30px; padding: 20px; background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%); border-radius: 10px;">
                    <p style="color: #2c3e50; font-size: 1.1rem; line-height: 1.6; margin: 0;">
                        Skip the endless swiping and superficial matches. LoveDashMatcher analyzes 29 dimensions of compatibility 
                        to find someone who truly aligns with your values, goals, and lifestyle. You get <strong>one carefully selected match at a time</strong>‚Äîsomeone 
                        worth getting to know, not just another profile to scroll past.
                    </p>
                </div>
                
                <div class="cta-buttons">
                    <button class="btn-primary" onclick="scrollToAuth()">Get Started Free</button>
                    <button class="btn-secondary" onclick="scrollToAbout()">Learn More</button>
                </div>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-card">
                    <div class="stat-number" id="totalMembers">0</div>
                    <div class="stat-label">Members Joined</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="spotsRemaining">10,000</div>
                    <div class="stat-label">Free Spots Remaining</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1</div>
                    <div class="stat-label">Match at a Time</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">29</div>
                    <div class="stat-label">Compatibility Dimensions</div>
                </div>
            </div>

            <!-- Why Different -->
            <div class="how-it-works">
                <h2>Why LoveDashMatcher Is Different</h2>
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>One Match at a Time</h3>
                        <p>No endless swiping or option paralysis. Focus on one carefully selected, highly compatible person at a time for meaningful connections.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>Deep Compatibility</h3>
                        <p>We analyze 29 dimensions of compatibility‚Äîfrom life goals and values to lifestyle and communication style‚Äînot just looks and hobbies.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>Privacy Protected</h3>
                        <p>Your photos and full profile stay private until both of you accept. Meet people who are genuinely interested in you, not just browsing.</p>
                    </div>
                </div>
            </div>

            <!-- About Section -->
            <div class="about-section" id="aboutSection">
                <h2>How It Works</h2>
                <p style="text-align: center; color: #6c757d; font-size: 1.1rem; margin-bottom: 40px; max-width: 800px; margin-left: auto; margin-right: auto;">
                    Deep compatibility analysis across 29 dimensions. One match at a time.
                </p>
                
                <div class="about-content">
                    <div class="about-box">
                        <h3>1Ô∏è‚É£ Build Your Profile</h3>
                        <p>Share your values, goals, and what matters most through natural conversation. We analyze 29 dimensions including life stage, family values, communication style, and lifestyle preferences.</p>
                    </div>
                    
                    <div class="about-box">
                        <h3>2Ô∏è‚É£ Get One Match</h3>
                        <p>Receive <strong>one carefully selected match</strong> based on deep compatibility. Focus on quality connections instead of endless options.</p>
                    </div>
                    
                    <div class="about-box">
                        <h3>3Ô∏è‚É£ Privacy Protected</h3>
                        <p>Your name and photos stay private until <strong>both accept</strong>. No browsing, no ghosting‚Äîjust mutual interest.</p>
                    </div>
                    
                    <div class="about-box">
                        <h3>4Ô∏è‚É£ Connect & Chat</h3>
                        <p>After mutual acceptance, exchange full profiles and start chatting. Take your time getting to know each other.</p>
                    </div>
                    
                    <div class="about-box">
                        <h3>üíé Free Lifetime Access</h3>
                        <p>First 10,000 members get free lifetime access. No hidden fees, no premium tiers.</p>
                    </div>
                </div>
            </div>

            <!-- Auth Section -->
            <div class="auth-section" id="authSection">
                <div class="auth-forms">
                    <div class="auth-box">
                        <h2>Sign Up</h2>
                        <form id="signupForm">
                            <div class="form-group">
                                <label for="signupEmail">Email Address</label>
                                <input type="email" id="signupEmail" required>
                            </div>
                            <div class="form-group">
                                <label for="signupAge">Age</label>
                                <input type="number" id="signupAge" min="18" required>
                            </div>
                            <button type="submit">Create Account</button>
                        </form>
                        <div id="signupMessage"></div>
                    </div>
                    
                    <div class="auth-box">
                        <h2>Login</h2>
                        <form id="loginForm">
                            <div class="form-group">
                                <label for="loginEmail">Email Address</label>
                                <input type="email" id="loginEmail" required>
                            </div>
                            <button type="submit">Login</button>
                        </form>
                        <div id="loginMessage"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Privacy Policy View -->
        <div id="privacyView" class="privacy-view">
            <div class="policy-container">
                <h1>Privacy Policy</h1>
                <p class="last-updated">Last Updated: November 11, 2025</p>
                
                <h2>No Guarantees</h2>
                <p><strong>We make no guarantees</strong> regarding data security, match quality, or service outcomes. Use at your own risk.</p>
                
                <h2>What We Collect</h2>
                <p>Email, age, name, chat conversations, compatibility responses, photos (up to 3), usage data, and technical information.</p>
                
                <h2>How We Use It</h2>
                <p>To build your profile, match you with compatible members, facilitate messaging, and improve our service.</p>
                
                <h2>Who Sees Your Data</h2>
                <ul>
                    <li><strong>Matches:</strong> Age and location initially. Name and photos only after mutual acceptance.</li>
                    <li><strong>Service Providers:</strong> AWS (hosting), OpenAI (AI chat), and other third-party services.</li>
                    <li><strong>Legal:</strong> We may disclose data if required by law.</li>
                </ul>
                
                <h2>Security</h2>
                <p>We implement reasonable security but make no guarantees. Data is stored on AWS cloud services. Once you share photos with matches, we cannot control how they're used.</p>
                
                <h2>Your Rights</h2>
                <p>View your profile anytime. Request deletion by contacting us (no guarantee of complete removal from backups). Toggle matching on/off.</p>
                
                <h2>Age & Changes</h2>
                <p>Must be 18+. We don't verify ages. We may update this policy anytime without notice.</p>
                
                <h2>Contact</h2>
                <p>Questions? Email: <a href="mailto:mickeyshaughnessy@gmail.com">mickeyshaughnessy@gmail.com</a></p>
                
                <button class="btn-primary" onclick="showView('landing')" style="margin-top: 30px;">Back to Home</button>
            </div>
        </div>

        <!-- Terms of Service View -->
        <div id="termsView" class="terms-view">
            <div class="policy-container">
                <h1>Terms of Service</h1>
                <p class="last-updated">Last Updated: November 11, 2025</p>
                
                <h2>1. Acceptance of Terms</h2>
                <p>By using LoveDashMatcher, you agree to these Terms of Service. If you don't agree, don't use the service. <strong>We reserve the right to modify these terms at any time without notice.</strong></p>
                
                <h2>2. Service Description</h2>
                <p>LoveDashMatcher is an experimental AI-powered matchmaking service. We provide:</p>
                <ul>
                    <li>AI chatbot for building compatibility profiles</li>
                    <li>Matching algorithm based on 29 compatibility dimensions</li>
                    <li>Private messaging between mutually accepted matches</li>
                    <li>Profile and photo sharing after mutual acceptance</li>
                </ul>
                <p><strong>We make no guarantees</strong> about match quality, service availability, or results.</p>
                
                <h2>3. Eligibility</h2>
                <p>You must be at least 18 years old. By using this service, you represent that you are of legal age. We do not verify ages and are not responsible if ineligible users access the service.</p>
                
                <h2>4. Account Responsibility</h2>
                <p>You are responsible for:</p>
                <ul>
                    <li>Keeping your login credentials secure (if you set a password)</li>
                    <li>All activity that occurs under your account</li>
                    <li>Any content you upload, including photos and chat messages</li>
                    <li>How you interact with other members</li>
                </ul>
                
                <h2>5. Prohibited Conduct</h2>
                <p>You agree not to:</p>
                <ul>
                    <li>Impersonate others or provide false information</li>
                    <li>Upload photos that aren't of you or that you don't have rights to use</li>
                    <li>Harass, threaten, or abuse other users</li>
                    <li>Use the service for commercial purposes or spam</li>
                    <li>Attempt to hack, scrape, or reverse engineer the platform</li>
                    <li>Share explicit sexual content or illegal material</li>
                    <li>Violate any applicable laws or regulations</li>
                </ul>
                <p><strong>Violations may result in account suspension or termination without warning or refund.</strong></p>
                
                <h2>6. User Content</h2>
                <p>By uploading photos or submitting chat messages:</p>
                <ul>
                    <li>You grant us a worldwide, royalty-free license to use, store, and display your content</li>
                    <li>You represent that you own the rights to the content</li>
                    <li>You acknowledge that content may be stored indefinitely</li>
                    <li>You understand that matched users may save or share your content outside the platform</li>
                </ul>
                
                <h2>7. Matching and Connections</h2>
                <p>Important disclaimers:</p>
                <ul>
                    <li>We do not guarantee matches or verify user identities</li>
                    <li>We are not responsible for the behavior of other users</li>
                    <li>You meet other users at your own risk‚Äîuse common sense and safety precautions</li>
                    <li>We do not conduct background checks or verify information users provide</li>
                    <li>Any relationships, dates, or meetups that result are your sole responsibility</li>
                </ul>
                
                <h2>8. Free Lifetime Membership</h2>
                <p>The first 10,000 members receive free lifetime access. However:</p>
                <ul>
                    <li>We may change pricing, features, or access at any time</li>
                    <li>Free accounts may be limited in features compared to potential future paid tiers</li>
                    <li>"Lifetime" means the lifetime of the service, which could end at any time</li>
                    <li>We reserve the right to terminate free accounts for any reason</li>
                </ul>
                
                <h2>9. Service Availability</h2>
                <p>We provide the service "as is" with no uptime guarantees. The service may be unavailable due to maintenance, technical issues, or at our discretion. We may shut down the service permanently at any time without notice.</p>
                
                <h2>10. Termination</h2>
                <p>We may terminate or suspend your account at any time, for any reason, without warning. You may delete your account by contacting us, but we make no guarantees about data removal from backups.</p>
                
                <h2>11. Disclaimers</h2>
                <p><strong>LOVDASHMATCHER IS PROVIDED "AS IS" WITHOUT WARRANTIES OF ANY KIND.</strong> We disclaim all warranties, express or implied, including:</p>
                <ul>
                    <li>Merchantability, fitness for a particular purpose</li>
                    <li>Security, reliability, or accuracy of the service</li>
                    <li>Quality of matches or likelihood of finding a relationship</li>
                    <li>Protection of your personal information or photos</li>
                </ul>
                
                <h2>12. Limitation of Liability</h2>
                <p><strong>WE ARE NOT LIABLE FOR ANY DAMAGES</strong> arising from your use of LoveDashMatcher, including:</p>
                <ul>
                    <li>Data breaches, hacks, or unauthorized access to your information</li>
                    <li>Actions of other users, including harassment, fraud, or violence</li>
                    <li>Failed relationships, heartbreak, or emotional distress</li>
                    <li>Financial losses or wasted time</li>
                    <li>Any direct, indirect, incidental, or consequential damages</li>
                </ul>
                <p>You agree to use the service at your own risk and hold us harmless for any outcomes.</p>
                
                <h2>13. Indemnification</h2>
                <p>You agree to indemnify and hold harmless LoveDashMatcher, its operators, and affiliates from any claims, damages, or expenses arising from:</p>
                <ul>
                    <li>Your use of the service</li>
                    <li>Your violation of these terms</li>
                    <li>Your interactions with other users</li>
                    <li>Any content you upload or submit</li>
                </ul>
                
                <h2>14. Governing Law</h2>
                <p>These terms are governed by the laws of the United States and the State of California, without regard to conflict of law provisions. Any disputes will be resolved in California courts.</p>
                
                <h2>15. Changes to Terms</h2>
                <p>We may modify these Terms of Service at any time. Continued use of the service after changes constitutes acceptance. We are not obligated to notify you of changes.</p>
                
                <h2>16. Entire Agreement</h2>
                <p>These Terms, along with our Privacy Policy, constitute the entire agreement between you and LoveDashMatcher. Previous agreements or representations, whether written or oral, are superseded.</p>
                
                <h2>17. Contact</h2>
                <p>Questions about these terms? Contact: <a href="mailto:mickeyshaughnessy@gmail.com">mickeyshaughnessy@gmail.com</a></p>
                <p>We will try to respond but make no guarantees.</p>
                
                <p style="margin-top: 40px; padding: 20px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 8px;">
                    <strong>‚ö†Ô∏è Important Reminder:</strong> LoveDashMatcher is an experimental service with no guarantees. Meet other users safely, protect your personal information, and use common sense. We are not responsible for what happens outside or inside this platform.
                </p>
                
                <button class="btn-primary" onclick="showView('landing')" style="margin-top: 30px;">Back to Home</button>
            </div>
        </div>

        <!-- Chat View -->
        <div id="chatView" class="chat-view">
            <div class="chat-container">
                <div class="chat-main">
                    <div class="chat-header">
                        <h3>üèóÔ∏è Build Your Profile</h3>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai">
                            <div>Hi! Let's build your profile together. First, tell me your name, where you're located, and a bit about yourself. Then we'll dive into what matters most to you in a relationship.</div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" id="chatInput" placeholder="Type your message...">
                        <button onclick="sendMessage()">Send</button>
                    </div>
                </div>

                <div class="chat-sidebar">
                    <div class="sidebar-section">
                        <div class="sidebar-title">üéØ Profile Progress</div>
                        <div class="profile-progress">
                            <div class="progress-label">
                                <span><span id="sidebarDimensionCount">0</span>/29 Dimensions</span>
                                <span id="sidebarPercentage">0%</span>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="sidebarProgressBar" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Photo Upload in Build Profile View -->
                    <div class="sidebar-section">
                        <div class="sidebar-title">üì∏ Your Photos</div>
                        <p style="color: #6c757d; font-size: 0.85rem; margin-bottom: 12px;">
                            Upload up to 3 photos (shown to matches after mutual acceptance)
                        </p>
                        <div class="photo-grid" id="chatPhotoGrid" style="grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                            <div class="photo-item photo-item-empty" style="aspect-ratio: 1;">
                                <span>+</span>
                            </div>
                            <div class="photo-item photo-item-empty" style="aspect-ratio: 1;">
                                <span>+</span>
                            </div>
                            <div class="photo-item photo-item-empty" style="aspect-ratio: 1;">
                                <span>+</span>
                            </div>
                        </div>
                        <input type="file" id="chatPhotoUploadInput" accept="image/*" style="display: none;" onchange="handleChatPhotoSelect(event)">
                        <button class="photo-upload-btn" id="chatPhotoUploadBtn" onclick="triggerChatPhotoUpload()" style="padding: 8px; font-size: 0.9rem;">
                            üì§ Upload Photo
                        </button>
                        <p style="color: #6c757d; font-size: 0.75rem; margin-top: 8px; text-align: center;">Max 5MB ‚Ä¢ JPG, PNG, GIF</p>
                    </div>

                    <div class="sidebar-section" style="flex: 1; display: flex; flex-direction: column;">
                        <div class="sidebar-title">üìÑ Raw Profile JSON</div>
                        <div id="jsonViewer" class="json-viewer">
                            {
  "dimensions": {},
  "status": "building profile..."
}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Match View -->
        <div id="matchView" class="matches-view">
            <div class="matches-header">
                <h2>Your Match</h2>
                <p style="color: #6c757d; margin-top: 10px;">Based on 29-dimension compatibility analysis</p>
                
                <!-- Active/Inactive Toggle -->
                <div class="toggle-container">
                    <span class="toggle-label">Matching Status:</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="matchingActiveToggle" onchange="toggleMatchingStatus()">
                        <span class="toggle-slider"></span>
                    </label>
                    <span id="matchingStatusLabel" class="status-text active">Active</span>
                </div>
            </div>
            <div id="matchContainer" style="max-width: 800px; margin: 0 auto;">
                <!-- Match content will be loaded here -->
                <div style="text-align: center; padding: 40px; color: #2c3e50;">
                    <div style="font-size: 3rem; margin-bottom: 20px;">üîç</div>
                    <h3 style="color: #2c3e50;">No match yet</h3>
                    <p style="color: #34495e;">Complete your profile to get matched!</p>
                    <button class="btn-primary" onclick="showView('chat')" style="margin-top: 20px;">Continue Building Profile</button>
                </div>
            </div>
        </div>

        <!-- Profile View (Combined with Match) -->
        <div id="profileView" class="profile-view">
            <div class="profile-layout">
                <div>
                    <div class="profile-container">
                        <div class="profile-header">
                            <h2>Connect with Match</h2>
                            <p style="color: #6c757d;">Your profile and matches</p>
                            
                            <!-- Prominent Active/Inactive Toggle -->
                            <div class="toggle-container" style="margin-top: 20px;">
                                <span class="toggle-label">Matching Status:</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="mainMatchingToggle" onchange="toggleMainMatchingStatus()">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="mainMatchingStatusLabel" class="status-text active">Active</span>
                            </div>
                        </div>
                        
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profileDimCount">0</div>
                                <div class="profile-stat-label">Dimensions Filled</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profileCompletion">0%</div>
                                <div class="profile-stat-label">Completion</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profileConvos">0</div>
                                <div class="profile-stat-label">Conversations</div>
                            </div>
                        </div>
                        
                        <!-- Basic Info Section -->
                        <div style="margin: 25px 0; padding: 20px; background: linear-gradient(135deg, #667eea05 0%, #764ba205 100%); border-radius: 12px; border-left: 4px solid #764ba2;">
                            <h3 style="color: #764ba2; margin-bottom: 15px; font-size: 1.2rem;">üë§ Basic Info</h3>
                            <div id="basicInfoDisplay" style="color: #2c3e50;">
                                <p style="margin-bottom: 10px;"><strong>Name:</strong> <span id="profileName">Not set</span></p>
                                <p style="margin-bottom: 10px;"><strong>Age:</strong> <span id="profileAge">-</span></p>
                                <p style="margin-bottom: 10px;"><strong>Location:</strong> <span id="profileLocation">Not set</span></p>
                                <p style="margin-bottom: 15px;"><strong>About:</strong></p>
                                <p id="profileAbout" style="color: #6c757d; font-style: italic; line-height: 1.6; padding: 10px; background: white; border-radius: 6px;">
                                    Share something about yourself in the Build section...
                                </p>
                            </div>
                            <p style="color: #6c757d; font-size: 0.9rem; margin-top: 15px; text-align: center;">
                                Update your info in the <a href="#" onclick="showView('chat'); return false;" style="color: #764ba2; font-weight: 600;">Build Profile</a> section
                            </p>
                        </div>
                    </div>
                    
                    <!-- Match Section -->
                    <div id="matchSection" style="margin-top: 20px;">
                        <!-- Match content will be loaded here -->
                    </div>
                </div>
                
                <div class="json-panel">
                    <h3>üìÑ Raw Profile JSON</h3>
                    <div id="profileJsonViewer" class="json-scroll">
                        {
  "loading": "profile data..."
}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>üî∑ LoveDashMatcher</h3>
                <p>AI-powered matchmaking using 29-dimension compatibility analysis for meaningful, lasting relationships.</p>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <a href="#" onclick="scrollToAuth(); return false;">Sign Up</a>
                <a href="#" onclick="scrollToAbout(); return false;">About</a>
                <a href="#" onclick="showView('privacy'); return false;">Privacy Policy</a>
                <a href="#" onclick="showView('terms'); return false;">Terms of Service</a>
            </div>
            
            <div class="footer-section">
                <h3>Support</h3>
                <a href="mailto:mickeyshaughnessy@gmail.com">Contact Support</a>
                <p style="color: #6c757d; margin-top: 10px;">‚úâÔ∏è mickeyshaughnessy@gmail.com</p>
            </div>
            
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 LoveDashMatcher. All rights reserved. | Made with ‚ù§Ô∏è by AI</p>
        </div>
    </footer>

    <script>
        const API_URL = 'https://rse-api.com:5009';
        let authToken = null;
        let currentUser = null;
        let matchMessagesInterval = null;
        
        // Toast notification system
        function showToast(message, type = 'info') {
            const toastHTML = `
                <div class="toast ${type}">
                    <div class="toast-icon">${type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : '‚Ñπ'}</div>
                    <div class="toast-message">${message}</div>
                    <div class="toast-close" onclick="this.parentElement.remove()">√ó</div>
                </div>
            `;
            
            const toast = document.createElement('div');
            toast.innerHTML = toastHTML;
            document.body.appendChild(toast.firstElementChild);
            
            // Auto-remove after 3 seconds
            setTimeout(() => {
                const toastEl = document.querySelector('.toast:last-of-type');
                if (toastEl) toastEl.remove();
            }, 3000);
        }
        
        // Show typing indicator
        function showTypingIndicator() {
            const messagesDiv = document.getElementById('chatMessages');
            const indicator = document.createElement('div');
            indicator.className = 'typing-indicator';
            indicator.id = 'typingIndicator';
            indicator.innerHTML = '<span></span><span></span><span></span>';
            messagesDiv.appendChild(indicator);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        // Remove typing indicator
        function removeTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.remove();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadMemberStats();
            checkAutoLogin();
        });
        
        // Check for saved session and auto-login
        function checkAutoLogin() {
            const savedToken = localStorage.getItem('authToken');
            const savedUser = localStorage.getItem('currentUser');
            
            if (savedToken && savedUser) {
                authToken = savedToken;
                currentUser = JSON.parse(savedUser);
                document.getElementById('mainNav').classList.add('active');
                showView('chat');
            }
        }

        // Load membership statistics
        async function loadMemberStats() {
            try {
                const response = await fetch(`${API_URL}/stats`);
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('totalMembers').textContent = data.total_members.toLocaleString();
                    document.getElementById('spotsRemaining').textContent = data.spots_remaining.toLocaleString();
                }
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Scroll functions
        function scrollToAuth() {
            document.getElementById('authSection').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function scrollToAbout() {
            document.getElementById('aboutSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // View management
        function showView(viewName) {
            // Clear any existing message polling
            if (matchMessagesInterval) {
                clearInterval(matchMessagesInterval);
                matchMessagesInterval = null;
            }
            
            // Hide all views
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('chatView').style.display = 'none';
            document.getElementById('matchView').style.display = 'none';
            document.getElementById('profileView').style.display = 'none';
            document.getElementById('privacyView').style.display = 'none';
            document.getElementById('termsView').style.display = 'none';

            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));

            // Show selected view
            switch(viewName) {
                case 'landing':
                    document.getElementById('landingPage').style.display = 'block';
                    // Hide nav when on landing page (unless logged in)
                    if (!authToken) {
                        document.getElementById('mainNav').classList.remove('active');
                    }
                    break;
                case 'chat':
                    document.getElementById('chatView').style.display = 'block';
                    document.querySelectorAll('.nav-link')[1].classList.add('active');
                    loadChatHistory();
                    break;
                case 'profile':
                    document.getElementById('profileView').style.display = 'block';
                    document.querySelectorAll('.nav-link')[2].classList.add('active');
                    loadProfile();
                    break;
                case 'privacy':
                    document.getElementById('privacyView').style.display = 'block';
                    break;
                case 'terms':
                    document.getElementById('termsView').style.display = 'block';
                    break;
            }

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Signup
        document.getElementById('signupForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('signupEmail').value.trim();
            const age = parseInt(document.getElementById('signupAge').value);
            
            // Input validation
            if (!email || !email.includes('@')) {
                showToast('Please enter a valid email address', 'error');
                return;
            }
            
            if (age < 18 || age > 120) {
                showToast('Age must be between 18 and 120', 'error');
                return;
            }
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner"></span>Creating...';
            
            try {
                const response = await fetch(`${API_URL}/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, age })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    authToken = data.token;
                    currentUser = data;
                    
                    // Save to localStorage for auto-login
                    localStorage.setItem('authToken', authToken);
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    showToast(data.message || 'Account created successfully!', 'success');
                    document.getElementById('signupMessage').innerHTML = 
                        `<div class="success">${data.message}</div>`;
                    
                    // Show chat to start building profile
                    setTimeout(() => {
                        document.getElementById('mainNav').classList.add('active');
                        showView('chat');
                    }, 1500);
                } else {
                    const errorMsg = data.error || 'Signup failed';
                    showToast(errorMsg, 'error');
                    document.getElementById('signupMessage').innerHTML = 
                        `<div class="error">${errorMsg}</div>`;
                }
            } catch (error) {
                const errorMsg = 'Connection error. Please try again.';
                showToast(errorMsg, 'error');
                document.getElementById('signupMessage').innerHTML = 
                    `<div class="error">${errorMsg}</div>`;
                console.error('Signup error:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Create Account';
            }
        });

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value.trim();
            
            // Input validation
            if (!email || !email.includes('@')) {
                showToast('Please enter a valid email address', 'error');
                return;
            }
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner"></span>Logging in...';
            
            try {
                const response = await fetch(`${API_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    authToken = data.token;
                    currentUser = data;
                    
                    // Save to localStorage for auto-login
                    localStorage.setItem('authToken', authToken);
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    showToast('Login successful!', 'success');
                    document.getElementById('loginMessage').innerHTML = 
                        `<div class="success">Login successful!</div>`;
                    
                    // Show chat view
                    setTimeout(() => {
                        document.getElementById('mainNav').classList.add('active');
                        showView('chat');
                    }, 1000);
                } else {
                    const errorMsg = data.error || 'Login failed';
                    showToast(errorMsg, 'error');
                    document.getElementById('loginMessage').innerHTML = 
                        `<div class="error">${errorMsg}</div>`;
                }
            } catch (error) {
                const errorMsg = 'Connection error. Please try again.';
                showToast(errorMsg, 'error');
                document.getElementById('loginMessage').innerHTML = 
                    `<div class="error">${errorMsg}</div>`;
                console.error('Login error:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Login';
            }
        });



        // Load chat history
        async function loadChatHistory() {
            try {
                const response = await fetch(`${API_URL}/chat/history`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                
                if (response.ok && data.messages.length > 0) {
                    const chatMessages = document.getElementById('chatMessages');
                    chatMessages.innerHTML = '';
                    
                    data.messages.forEach(msg => {
                        addMessage(msg.user, 'user', msg.timestamp);
                        addMessage(msg.ai, 'ai', msg.timestamp);
                    });
                } else {
                    // Show initial message if no history
                    const chatMessages = document.getElementById('chatMessages');
                    if (chatMessages.children.length === 0) {
                        chatMessages.innerHTML = `
                            <div class="message ai">
                                <div>Hi! Let's build your profile together. First, tell me your name, where you're located, and a bit about yourself. Then we'll dive into what matters most to you in a relationship.</div>
                                <div class="message-time">Just now</div>
                            </div>
                        `;
                    }
                }
                
                // Update sidebar
                updateChatSidebar();
            } catch (error) {
                console.error('Error loading chat history:', error);
            }
        }

        // Update chat sidebar with dimension progress
        async function updateChatSidebar() {
            try {
                const response = await fetch(`${API_URL}/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const profile = await response.json();
                
                if (response.ok) {
                    const dimensionsCount = Object.keys(profile.dimensions || {}).length;
                    const percentage = Math.round((dimensionsCount / 29) * 100);
                    
                    document.getElementById('sidebarDimensionCount').textContent = dimensionsCount;
                    document.getElementById('sidebarPercentage').textContent = `${percentage}%`;
                    document.getElementById('sidebarProgressBar').style.width = `${percentage}%`;
                    
                    // Update photos in Build Profile sidebar
                    renderPhotos(profile.photos || [], 'chatPhotoGrid', 'chatPhotoUploadBtn');
                    
                    // Update JSON viewer
                    const jsonViewer = document.getElementById('jsonViewer');
                    if (jsonViewer) {
                        jsonViewer.textContent = JSON.stringify(profile, null, 2);
                    }
                }
            } catch (error) {
                console.error('Error updating sidebar:', error);
            }
        }

        // Send message
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const sendBtn = input.nextElementSibling;
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessage(message, 'user');
            input.value = '';
            
            // Disable input and show spinner
            input.disabled = true;
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<span class="spinner"></span>Sending...';
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                const response = await fetch(`${API_URL}/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ message })
                });
                
                const data = await response.json();
                
                // Remove typing indicator
                removeTypingIndicator();
                
                if (response.ok) {
                    addMessage(data.response, 'ai', data.timestamp);
                    updateChatSidebar();
                } else {
                    const errorMsg = data.error || 'Sorry, there was an error. Please try again.';
                    addMessage(errorMsg, 'ai');
                    showToast(errorMsg, 'error');
                }
            } catch (error) {
                removeTypingIndicator();
                const errorMsg = 'Connection error. Please try again.';
                addMessage(errorMsg, 'ai');
                showToast(errorMsg, 'error');
                console.error('Chat error:', error);
            } finally {
                // Re-enable input and remove spinner
                input.disabled = false;
                sendBtn.disabled = false;
                sendBtn.innerHTML = 'Send';
                input.focus();
            }
        }

        // Add message to chat
        function addMessage(text, type, timestamp) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const timeStr = timestamp ? new Date(timestamp).toLocaleTimeString() : 'Just now';
            
            messageDiv.innerHTML = `
                <div>${text}</div>
                <div class="message-time">${timeStr}</div>
            `;
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // Keyboard shortcuts for chat input
        document.getElementById('chatInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            } else if (e.key === 'Escape') {
                e.target.value = '';
                e.target.blur();
            }
        });

        // Load current match
        async function loadMatch() {
            try {
                const response = await fetch(`${API_URL}/match`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                
                // Update matching toggle status - read from top level of response
                const isActive = data.matching_active !== false;
                const statusLabel = document.getElementById('matchingStatusLabel');
                document.getElementById('matchingActiveToggle').checked = isActive;
                statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                
                const matchContainer = document.getElementById('matchContainer');
                
                if (response.ok && data.match) {
                    const match = data.match;
                    matchContainer.innerHTML = createMatchCard(match, isActive);
                    
                    // Load match messages if both users accepted (mutual acceptance)
                    if (match.mutual_acceptance) {
                        loadMatchMessages();
                    }
                } else {
                    // No match yet
                    const profileComplete = data.profile_complete;
                    const dimensionsCount = data.dimensions_count || 0;
                    
                    matchContainer.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #2c3e50;">
                            <div style="font-size: 3rem; margin-bottom: 20px;">üîç</div>
                            <h3 style="color: #2c3e50; margin-bottom: 15px;">${data.message || 'No match yet'}</h3>
                            ${!profileComplete ? `
                                <p style="color: #34495e; margin-bottom: 20px;">You have ${dimensionsCount}/29 dimensions filled.</p>
                                <button class="btn-primary" onclick="showView('chat')" style="margin-top: 20px;">Continue Building Profile</button>
                            ` : `
                                <p style="color: #34495e;">Your profile is complete! We'll notify you when we find a great match.</p>
                            `}
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading match:', error);
            }
        }

        // Create match card
        function createMatchCard(match, isActive) {
            const score = match.match_score || 0;
            const userAccepted = match.user_accepted || false;
            const matchAccepted = match.match_accepted || false;
            const mutualAcceptance = match.mutual_acceptance || false;
            
            // Match analysis
            const analysis = match.match_analysis || {};
            const reasoning = analysis.reasoning || 'AI-powered compatibility analysis';
            const strengths = analysis.strengths || 'Analyzing compatibility...';
            const concerns = analysis.concerns || 'None identified';
            
            let profileDataHtml = '';
            if (mutualAcceptance && match.full_profile) {
                // Show full profile JSON after mutual acceptance
                const fullProfile = match.full_profile;
                const profileKeys = Object.keys(fullProfile);
                const profileItems = profileKeys.map(key => {
                    const value = typeof fullProfile[key] === 'object' ? JSON.stringify(fullProfile[key]) : fullProfile[key];
                    return `<div style="margin-bottom: 10px;"><strong>${key}:</strong> ${value}</div>`;
                }).join('');
                
                profileDataHtml = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 20px;">
                        <h4 style="color: #764ba2; margin-bottom: 15px;">üìã Match Profile (${profileKeys.length} dimensions)</h4>
                        <div style="max-height: 300px; overflow-y: auto; font-size: 0.9rem;">
                            ${profileItems}
                        </div>
                    </div>
                `;
            } else if (match.preview) {
                // Show limited preview before acceptance
                const preview = match.preview;
                profileDataHtml = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 20px;">
                        <h4 style="color: #764ba2; margin-bottom: 15px;">üë§ Match Preview</h4>
                        <p><strong>Age:</strong> ${preview.age || 'N/A'}</p>
                        <p><strong>Location:</strong> ${preview.location || 'N/A'}</p>
                        <p><strong>Profile Completion:</strong> ${preview.completion_percentage || 0}%</p>
                        <p style="color: #6c757d; font-style: italic; margin-top: 10px;">
                            Accept the match to see full profile details and start chatting!
                        </p>
                    </div>
                `;
            }
            
            let actionsHtml = '';
            if (!userAccepted) {
                // Show accept/decline buttons
                actionsHtml = `
                    <div class="match-actions" style="margin-top: 20px;">
                        <p style="color: #6c757d; margin-bottom: 15px; text-align: center;">
                            Review this match and decide if you'd like to connect
                        </p>
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button class="btn-primary" onclick="acceptMatch()" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                                ‚úì Accept Match
                            </button>
                            <button class="btn-reject" onclick="rejectMatch()">
                                ‚úó Decline Match
                            </button>
                        </div>
                    </div>
                `;
            } else if (!mutualAcceptance) {
                // User accepted, waiting for match to accept
                actionsHtml = `
                    <div style="background: #d1ecf1; padding: 20px; border-radius: 8px; margin-top: 20px; text-align: center;">
                        <h4 style="color: #0c5460; margin-bottom: 10px;">‚è≥ Waiting for Match Response</h4>
                        <p style="color: #0c5460;">You've accepted this match! Waiting for them to accept too.</p>
                        <p style="color: #0c5460; font-size: 0.9rem; margin-top: 10px;">
                            Chat will be enabled once both of you accept.
                        </p>
                    </div>
                `;
            } else {
                // Both accepted - show chat interface
                actionsHtml = `
                    <div class="match-chat-container" style="margin-top: 20px;">
                        <h3 style="margin-bottom: 15px; color: #764ba2;">üí¨ Private Chat</h3>
                        <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                            <p style="color: #155724; font-weight: 600;">üéâ Match Accepted! You can now chat privately.</p>
                        </div>
                        <div class="match-chat-messages" id="matchChatMessages">
                            <div style="text-align: center; color: #6c757d; padding: 20px;">
                                Start a conversation!
                            </div>
                        </div>
                        <div class="match-chat-input-area">
                            <input type="text" id="matchChatInput" placeholder="Type your message...">
                            <button onclick="sendMatchMessage()">Send</button>
                        </div>
                    </div>
                `;
            }
            
            return `
                <div class="match-card">
                    <div class="match-score">
                        <div class="compatibility-circle">${score}%</div>
                        <div style="color: #6c757d;">Compatibility</div>
                    </div>
                    <div class="match-info">
                        <h3>Your Match</h3>
                        <p style="color: #6c757d;">Age: ${match.age || 'N/A'}</p>
                        <p style="color: #6c757d; margin-top: 10px;">Matched on ${match.matched_at ? new Date(match.matched_at).toLocaleDateString() : 'recently'}</p>
                        ${userAccepted ? '<p style="color: #28a745; margin-top: 5px;">‚úì You accepted</p>' : ''}
                        ${matchAccepted ? '<p style="color: #28a745; margin-top: 5px;">‚úì Match accepted</p>' : ''}
                    </div>
                    <div style="background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%); padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <h4 style="color: #764ba2; margin-bottom: 10px;">üîç Compatibility Analysis</h4>
                        <p style="color: #2c3e50; margin-bottom: 8px;"><strong>Reasoning:</strong> ${reasoning}</p>
                        <p style="color: #2c3e50; margin-bottom: 8px;"><strong>Strengths:</strong> ${strengths}</p>
                        <p style="color: #2c3e50;"><strong>Considerations:</strong> ${concerns}</p>
                    </div>
                    ${profileDataHtml}
                    ${actionsHtml}
                </div>
            `;
        }

        // Toggle matching active/inactive
        async function toggleMatchingStatus() {
            const isActive = document.getElementById('matchingActiveToggle').checked;
            const statusLabel = document.getElementById('matchingStatusLabel');
            
            showToast(`Matching ${isActive ? 'activated' : 'deactivated'}`, 'info');
            
            try {
                const response = await fetch(`${API_URL}/match/toggle`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ active: isActive })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                    statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    showToast(`Matching ${isActive ? 'activated' : 'deactivated'} successfully`, 'success');
                    // Reload match view to show appropriate UI
                    loadMatch();
                } else {
                    showToast(data.error || 'Failed to update status', 'error');
                    // Revert toggle
                    document.getElementById('matchingActiveToggle').checked = !isActive;
                }
            } catch (error) {
                console.error('Error toggling status:', error);
                showToast('Connection error. Please try again.', 'error');
                document.getElementById('matchingActiveToggle').checked = !isActive;
            }
        }

        // Accept current match
        async function acceptMatch() {
            if (!confirm('Accept this match? This will allow both of you to chat once they also accept.')) {
                return;
            }
            
            showToast('Accepting match...', 'info');
            
            try {
                const response = await fetch(`${API_URL}/match/accept`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showToast(data.message || 'Match accepted successfully!', 'success');
                    loadMatch();
                } else {
                    showToast(data.error || 'Failed to accept match', 'error');
                }
            } catch (error) {
                console.error('Error accepting match:', error);
                showToast('Connection error. Please try again.', 'error');
            }
        }

        // Reject current match
        async function rejectMatch() {
            if (!confirm('Decline this match? You will be matched with someone new in the next cycle.')) {
                return;
            }
            
            showToast('Declining match...', 'info');
            
            try {
                const response = await fetch(`${API_URL}/match/reject`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showToast(data.message || 'Match declined successfully', 'success');
                    loadMatch();
                } else {
                    showToast(data.error || 'Failed to decline match', 'error');
                }
            } catch (error) {
                console.error('Error declining match:', error);
                showToast('Connection error. Please try again.', 'error');
            }
        }

        // Send message to match
        async function sendMatchMessage() {
            const input = document.getElementById('matchChatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            try {
                const response = await fetch(`${API_URL}/match/messages`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ message })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    input.value = '';
                    // Add message to UI immediately
                    addMatchMessage(message, 'sent', data.timestamp);
                } else {
                    alert(data.error || 'Failed to send message');
                }
            } catch (error) {
                console.error('Error sending message:', error);
                alert('Connection error. Please try again.');
            }
        }

        // Load match messages
        async function loadMatchMessages() {
            try {
                // Get current user profile to determine user_id
                const profileResponse = await fetch(`${API_URL}/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const profile = await profileResponse.json();
                const myUserId = profile.user_id;
                
                const response = await fetch(`${API_URL}/match/messages`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                
                if (response.ok && data.messages.length > 0) {
                    const messagesDiv = document.getElementById('matchChatMessages');
                    messagesDiv.innerHTML = '';
                    
                    data.messages.forEach(msg => {
                        const type = msg.from === myUserId ? 'sent' : 'received';
                        addMatchMessage(msg.message, type, msg.timestamp);
                    });
                }
            } catch (error) {
                console.error('Error loading match messages:', error);
            }
        }

        // Add match message to UI
        function addMatchMessage(text, type, timestamp) {
            const messagesDiv = document.getElementById('matchChatMessages');
            if (!messagesDiv) return;
            
            // Clear placeholder if exists
            if (messagesDiv.querySelector('[style*="text-align: center"]')) {
                messagesDiv.innerHTML = '';
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `match-message ${type}`;
            
            const timeStr = timestamp ? new Date(timestamp).toLocaleTimeString() : 'Just now';
            
            messageDiv.innerHTML = `
                <div>${text}</div>
                <div style="font-size: 0.75rem; opacity: 0.7; margin-top: 5px;">${timeStr}</div>
            `;
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // Enter key to send match message
        document.addEventListener('DOMContentLoaded', () => {
            document.addEventListener('keypress', (e) => {
                if (e.target.id === 'matchChatInput' && e.key === 'Enter') {
                    sendMatchMessage();
                }
            });
        });

        // Load profile (combined with match)
        async function loadProfile() {
            try {
                // Load profile data
                const response = await fetch(`${API_URL}/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const profile = await response.json();
                
                if (response.ok) {
                    // Update stats
                    const dimensionsCount = Object.keys(profile.dimensions || {}).length;
                    const percentage = Math.round((dimensionsCount / 29) * 100);
                    
                    document.getElementById('profileDimCount').textContent = dimensionsCount;
                    document.getElementById('profileCompletion').textContent = `${percentage}%`;
                    document.getElementById('profileConvos').textContent = profile.conversation_count || 0;
                    
                    // Set main matching toggle state
                    const isActive = profile.matching_active !== false;
                    const mainToggle = document.getElementById('mainMatchingToggle');
                    const mainStatusLabel = document.getElementById('mainMatchingStatusLabel');
                    if (mainToggle) {
                        mainToggle.checked = isActive;
                        mainStatusLabel.textContent = isActive ? 'Active' : 'Inactive';
                        mainStatusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    }
                    
                    // Update basic info
                    document.getElementById('profileName').textContent = profile.name || 'Not set';
                    document.getElementById('profileAge').textContent = profile.age || '-';
                    document.getElementById('profileLocation').textContent = profile.location || 'Not set';
                    document.getElementById('profileAbout').textContent = profile.about || 'Share something about yourself in the Build Profile section...';
                    document.getElementById('profileAbout').style.fontStyle = profile.about ? 'normal' : 'italic';
                    document.getElementById('profileAbout').style.color = profile.about ? '#2c3e50' : '#6c757d';
                    
                    // Update JSON viewer
                    const jsonViewer = document.getElementById('profileJsonViewer');
                    jsonViewer.textContent = JSON.stringify(profile, null, 2);
                    
                    // Load match data in the match section
                    await loadMatchInProfile();
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }
        
        // Load match data for profile view
        async function loadMatchInProfile() {
            try {
                const response = await fetch(`${API_URL}/match`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                const matchSection = document.getElementById('matchSection');
                
                if (response.ok && data.match) {
                    const match = data.match;
                    const isActive = data.matching_active !== false;
                    
                    matchSection.innerHTML = `
                        <div class="matches-header">
                            <h2>Your Match</h2>
                            <p style="color: #6c757d; margin-top: 10px;">Based on 29-dimension compatibility analysis</p>
                            
                            <div class="toggle-container">
                                <span class="toggle-label">Matching Status:</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="profileMatchToggle" ${isActive ? 'checked' : ''} onchange="toggleMatchingStatusFromProfile()">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="profileMatchStatusLabel" class="status-text ${isActive ? 'active' : 'inactive'}">${isActive ? 'Active' : 'Inactive'}</span>
                            </div>
                        </div>
                        
                        ${createMatchCard(match, isActive)}
                    `;
                } else {
                    matchSection.innerHTML = `
                        <div class="matches-header">
                            <h2>Your Match</h2>
                            <p style="color: #6c757d; margin-top: 10px;">No match yet. Complete your profile to get matched!</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading match:', error);
            }
        }
        
        // Toggle main matching status from profile view
        async function toggleMainMatchingStatus() {
            const isActive = document.getElementById('mainMatchingToggle').checked;
            const statusLabel = document.getElementById('mainMatchingStatusLabel');
            
            try {
                const response = await fetch(`${API_URL}/match/toggle`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ active: isActive })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                    statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    showToast(`Matching ${isActive ? 'activated' : 'deactivated'}`, 'success');
                    loadMatchInProfile();
                } else {
                    showToast(data.error || 'Failed to update status', 'error');
                    document.getElementById('mainMatchingToggle').checked = !isActive;
                }
            } catch (error) {
                console.error('Error toggling status:', error);
                showToast('Connection error. Please try again.', 'error');
                document.getElementById('mainMatchingToggle').checked = !isActive;
            }
        }
        
        // Toggle matching status from profile view (secondary toggle in match section)
        async function toggleMatchingStatusFromProfile() {
            const isActive = document.getElementById('profileMatchToggle').checked;
            const statusLabel = document.getElementById('profileMatchStatusLabel');
            
            try {
                const response = await fetch(`${API_URL}/match/toggle`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ active: isActive })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                    statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    showToast(`Matching ${isActive ? 'activated' : 'deactivated'}`, 'success');
                    // Also update main toggle
                    const mainToggle = document.getElementById('mainMatchingToggle');
                    const mainStatusLabel = document.getElementById('mainMatchingStatusLabel');
                    if (mainToggle) {
                        mainToggle.checked = isActive;
                        mainStatusLabel.textContent = isActive ? 'Active' : 'Inactive';
                        mainStatusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    }
                    loadMatchInProfile();
                } else {
                    showToast(data.error || 'Failed to update status', 'error');
                    document.getElementById('profileMatchToggle').checked = !isActive;
                }
            } catch (error) {
                console.error('Error toggling status:', error);
                showToast('Connection error. Please try again.', 'error');
                document.getElementById('profileMatchToggle').checked = !isActive;
            }
        }

        // Photo upload functions for Build Profile (chat) view
        function triggerChatPhotoUpload() {
            document.getElementById('chatPhotoUploadInput').click();
        }
        
        function handleChatPhotoSelect(event) {
            // Use the same photo select handler but with chat-specific elements
            handlePhotoSelectGeneric(event, 'chatPhotoUploadBtn', 'chatPhotoUploadInput');
        }
        
        // Generic photo upload handler
        function triggerPhotoUpload() {
            const chatInput = document.getElementById('chatPhotoUploadInput');
            if (chatInput) {
                chatInput.click();
            }
        }
        
        // Wrapper for backward compatibility
        async function handlePhotoSelect(event) {
            return handlePhotoSelectGeneric(event, 'chatPhotoUploadBtn', 'chatPhotoUploadInput');
        }
        
        async function handlePhotoSelectGeneric(event, btnId, inputId) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validate file size (5MB max)
            if (file.size > 5 * 1024 * 1024) {
                showToast('Photo must be less than 5MB', 'error');
                return;
            }
            
            // Validate file type
            if (!file.type.startsWith('image/')) {
                showToast('Please upload an image file', 'error');
                return;
            }
            
            // Show loading state
            const uploadBtn = document.getElementById(btnId);
            uploadBtn.disabled = true;
            uploadBtn.innerHTML = '<span class="spinner"></span> Uploading...';
            
            try {
                // Create form data
                const formData = new FormData();
                formData.append('photo', file);
                
                const response = await fetch(`${API_URL}/profile/photos`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: formData
                });
                
                // Check if backend endpoint exists
                if (response.status === 404) {
                    showToast('Photo upload feature coming soon! Backend not yet available.', 'info');
                    uploadBtn.disabled = false;
                    uploadBtn.innerHTML = 'üì§ Upload Photo';
                    event.target.value = '';
                    return;
                }
                
                const data = await response.json();
                
                if (response.ok) {
                    showToast('Photo uploaded successfully!', 'success');
                    // Reload photos in current view
                    loadChatHistory(); // This will update sidebar photos
                    loadProfile(); // This will update if Connect with Match view is open
                } else {
                    showToast(data.error || 'Failed to upload photo', 'error');
                }
            } catch (error) {
                console.error('Photo upload error:', error);
                showToast('Photo upload feature coming soon! Backend not yet available.', 'info');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.innerHTML = 'üì§ Upload Photo';
                event.target.value = ''; // Reset file input
            }
        }
        
        async function deletePhoto(photoUrl) {
            if (!confirm('Delete this photo?')) return;
            
            try {
                const response = await fetch(`${API_URL}/profile/photos`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ photo_url: photoUrl })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showToast('Photo deleted', 'success');
                    loadProfile(); // Reload profile
                } else {
                    showToast(data.error || 'Failed to delete photo', 'error');
                }
            } catch (error) {
                console.error('Photo delete error:', error);
                showToast('Connection error. Please try again.', 'error');
            }
        }
        
        function renderPhotos(photos, gridId, btnId) {
            gridId = gridId || 'chatPhotoGrid';
            btnId = btnId || 'chatPhotoUploadBtn';
            
            const photoGrid = document.getElementById(gridId);
            const uploadBtn = document.getElementById(btnId);
            
            if (!photoGrid) return;
            
            photoGrid.innerHTML = '';
            
            // Show existing photos
            if (photos && photos.length > 0) {
                photos.forEach(photoUrl => {
                    const photoItem = document.createElement('div');
                    photoItem.className = 'photo-item';
                    photoItem.style.aspectRatio = '1';
                    photoItem.innerHTML = `
                        <img src="${photoUrl}" alt="Profile photo">
                        <button class="photo-delete-btn" onclick="deletePhoto('${photoUrl}')">√ó</button>
                    `;
                    photoGrid.appendChild(photoItem);
                });
            }
            
            // Add empty slots
            const emptySlots = 3 - (photos ? photos.length : 0);
            for (let i = 0; i < emptySlots; i++) {
                const emptyItem = document.createElement('div');
                emptyItem.className = 'photo-item photo-item-empty';
                emptyItem.style.aspectRatio = '1';
                emptyItem.innerHTML = '<span>+</span>';
                photoGrid.appendChild(emptyItem);
            }
            
            // Disable upload button if 3 photos already
            if (uploadBtn) {
                if (photos && photos.length >= 3) {
                    uploadBtn.disabled = true;
                    uploadBtn.textContent = '‚úì 3 Photos Uploaded';
                } else {
                    uploadBtn.disabled = false;
                    uploadBtn.innerHTML = 'üì§ Upload Photo';
                }
            }
        }
        
        // Logout
        function logout() {
            // Clear any intervals
            if (matchMessagesInterval) {
                clearInterval(matchMessagesInterval);
                matchMessagesInterval = null;
            }
            
            // Clear localStorage
            localStorage.removeItem('authToken');
            localStorage.removeItem('currentUser');
            
            authToken = null;
            currentUser = null;
            document.getElementById('mainNav').classList.remove('active');
            document.getElementById('landingPage').style.display = 'block';
            document.getElementById('chatView').style.display = 'none';
            document.getElementById('matchView').style.display = 'none';
            document.getElementById('profileView').style.display = 'none';
            document.getElementById('privacyView').style.display = 'none';
            document.getElementById('termsView').style.display = 'none';
            
            // Clear forms
            document.getElementById('signupForm').reset();
            document.getElementById('loginForm').reset();
            document.getElementById('signupMessage').innerHTML = '';
            document.getElementById('loginMessage').innerHTML = '';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
