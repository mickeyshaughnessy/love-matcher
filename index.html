<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveDashMatcher - AI-Powered Matchmaking</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        /* Navigation Bar */
        nav {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: none;
        }
        
        nav.active {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-brand {
            font-size: 1.3rem;
            font-weight: bold;
            color: #764ba2;
        }
        
        .nav-links {
            display: flex;
            gap: 25px;
            align-items: center;
        }
        
        .nav-link {
            color: #495057;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.2s;
            position: relative;
        }
        
        .nav-link:hover {
            background: #f8f9fa;
            color: #764ba2;
        }
        
        .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .nav-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: #dc3545;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Landing Page */
        .landing-page {
            display: block;
        }
        
        .hero {
            background: white;
            border-radius: 15px;
            padding: 60px 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .hero h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }
        
        .hero .tagline {
            font-size: 1.3rem;
            color: #6c757d;
            margin-bottom: 30px;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102,126,234,0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #764ba2;
            padding: 15px 40px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            border: 2px solid #764ba2;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .btn-secondary:hover {
            background: #764ba2;
            color: white;
        }
        
        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        /* How It Works Section */
        .how-it-works {
            background: white;
            border-radius: 15px;
            padding: 50px 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .how-it-works h2 {
            text-align: center;
            font-size: 2.2rem;
            color: #764ba2;
            margin-bottom: 40px;
        }
        
        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }
        
        .step {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 10px;
            position: relative;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        .step h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .step p {
            color: #6c757d;
            line-height: 1.6;
        }
        
        /* 29 Dimensions Showcase */
        .dimensions-showcase {
            background: white;
            border-radius: 15px;
            padding: 50px 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .dimensions-showcase h2 {
            text-align: center;
            font-size: 2.2rem;
            color: #764ba2;
            margin-bottom: 20px;
        }
        
        .dimensions-intro {
            text-align: center;
            color: #6c757d;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .dimensions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .dimension-card {
            background: linear-gradient(135deg, #667eea05 0%, #764ba205 100%);
            padding: 15px 20px;
            border-radius: 8px;
            border-left: 4px solid #764ba2;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .dimension-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(118,75,162,0.2);
        }
        
        .dimension-number {
            font-weight: bold;
            color: #764ba2;
            margin-right: 8px;
        }
        
        /* Dashboard View */
        .dashboard-view {
            display: none;
        }
        
        .dashboard-header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .welcome-message {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 10px;
        }
        
        .membership-badge {
            display: inline-block;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .profile-progress {
            margin-top: 20px;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: #6c757d;
            font-weight: 500;
        }
        
        .progress-bar-container {
            width: 100%;
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .dashboard-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .card-description {
            color: #6c757d;
            margin-bottom: 15px;
        }
        
        .card-action {
            color: #764ba2;
            font-weight: 600;
            text-decoration: none;
        }
        
        /* Chat View */
        .chat-view {
            display: none;
        }
        
        .chat-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            height: calc(100vh - 150px);
        }
        
        .chat-main {
            background: white;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-header h3 {
            font-size: 1.3rem;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 12px;
            max-width: 75%;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .message.ai {
            background: white;
            color: #333;
            border: 1px solid #e9ecef;
            border-bottom-left-radius: 4px;
        }
        
        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 5px;
        }
        
        .chat-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
        }
        
        .chat-input-area input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            transition: border 0.2s;
        }
        
        .chat-input-area input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .chat-input-area button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
            min-width: 100px;
        }
        
        .chat-input-area button:hover:not(:disabled) {
            transform: scale(1.05);
        }
        
        .chat-input-area button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            vertical-align: middle;
            margin-right: 6px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Chat Sidebar */
        .chat-sidebar {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .json-viewer {
            flex: 1;
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            overflow-y: auto;
            max-height: calc(100vh - 300px);
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
        }
        
        .sidebar-title {
            font-weight: 600;
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .dimension-progress {
            margin-bottom: 15px;
        }
        
        .dimension-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .dimension-item.completed {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-left: 3px solid #764ba2;
        }
        
        .dimension-item.active {
            background: linear-gradient(135deg, #FFD70015 0%, #FFA50015 100%);
            border-left: 3px solid #FFA500;
        }
        
        .dimension-status {
            font-size: 1.2rem;
        }
        
        /* Matches View */
        .matches-view {
            display: none;
        }
        
        .matches-header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .matches-header h2 {
            font-size: 2rem;
            color: #764ba2;
            margin-bottom: 10px;
        }
        
        .match-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .match-score {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .compatibility-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }
        
        .match-info {
            margin-bottom: 15px;
        }
        
        .match-info h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .shared-dimensions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }
        
        .dimension-tag {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            color: #764ba2;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .match-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .match-actions button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-reject {
            background: #dc3545;
            color: white;
        }
        
        .btn-reject:hover {
            background: #c82333;
        }
        
        /* Match Chat */
        .match-chat-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .match-chat-messages {
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .match-message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 12px;
            max-width: 75%;
            animation: slideIn 0.3s ease;
        }
        
        .match-message.sent {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .match-message.received {
            background: white;
            color: #333;
            border: 1px solid #e9ecef;
            border-bottom-left-radius: 4px;
        }
        
        .match-chat-input-area {
            display: flex;
            gap: 10px;
        }
        
        .match-chat-input-area input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            transition: border 0.2s;
        }
        
        .match-chat-input-area input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .match-chat-input-area button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .match-chat-input-area button:hover {
            transform: scale(1.05);
        }
        
        /* Profile View */
        .profile-view {
            display: none;
        }
        
        .profile-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .profile-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .profile-header {
            margin-bottom: 30px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 20px;
        }
        
        .profile-header h2 {
            color: #764ba2;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .profile-stat {
            background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .profile-stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #764ba2;
        }
        
        .profile-stat-label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 5px;
        }
        
        .dimensions-summary {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .dimension-chip {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            text-align: center;
            font-weight: 500;
        }
        
        .json-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .json-panel h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .json-scroll {
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            overflow-y: auto;
            max-height: 600px;
            white-space: pre-wrap;
            word-break: break-word;
            flex: 1;
        }
        
        /* Auth Section */
        .auth-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 20px auto;
            max-width: 900px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .auth-forms {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .auth-box {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
        }
        
        .auth-box h2 {
            color: #764ba2;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #495057;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .auth-box button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .auth-box button:hover {
            transform: translateY(-2px);
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            border: 1px solid #f5c6cb;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            border: 1px solid #c3e6cb;
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
            border-radius: 10px;
        }
        
        .toggle-label {
            font-weight: 600;
            font-size: 1.1rem;
            color: #333;
        }
        
        .status-text {
            font-weight: 700;
            font-size: 1.1rem;
            min-width: 80px;
            text-align: left;
        }
        
        .status-text.active {
            color: #28a745;
        }
        
        .status-text.inactive {
            color: #dc3545;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .auth-forms {
                grid-template-columns: 1fr;
            }
            
            .chat-container {
                grid-template-columns: 1fr;
            }
            
            .chat-sidebar {
                display: none;
            }
            
            .profile-layout {
                grid-template-columns: 1fr;
            }
            
            .json-panel {
                max-height: 400px;
            }
            
            .dimensions-grid {
                grid-template-columns: 1fr;
            }
            
            .steps {
                grid-template-columns: 1fr;
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar (Hidden until logged in) -->
    <nav id="mainNav">
        <div class="nav-brand">üî∑ LoveDashMatcher</div>
        <div class="nav-links">
            <a href="#" class="nav-link" onclick="showView('dashboard')">Dashboard</a>
            <a href="#" class="nav-link" onclick="showView('chat')">Chat with AI</a>
            <a href="#" class="nav-link" onclick="showView('profile')">
                Profile & Match
                <span class="nav-badge hidden" id="matchBadge">1</span>
            </a>
            <a href="#" class="nav-link" onclick="logout()">Logout</a>
        </div>
    </nav>

    <div class="container">
        <!-- Landing Page -->
        <div id="landingPage" class="landing-page">
            <!-- Hero Section -->
            <div class="hero">
                <h1>üî∑ LoveDashMatcher</h1>
                <p class="tagline">Find Your Perfect Match Through AI-Powered 29-Dimension Compatibility Analysis</p>
                
                <div style="max-width: 700px; margin: 0 auto 30px; padding: 20px; background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%); border-radius: 10px;">
                    <p style="color: #2c3e50; font-size: 1.1rem; line-height: 1.6; margin: 0;">
                        LoveDashMatcher uses advanced AI to understand what truly matters to you in a relationship. Through natural conversations, 
                        we build a comprehensive compatibility profile across 29 dimensions‚Äîfrom faith and family to lifestyle and humor. 
                        Our algorithm then finds your most compatible matches for meaningful, lasting connections.
                    </p>
                </div>
                
                <div class="cta-buttons">
                    <button class="btn-primary" onclick="scrollToAuth()">Get Started Free</button>
                    <button class="btn-secondary" onclick="scrollToDimensions()">Learn More</button>
                </div>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-card">
                    <div class="stat-number" id="totalMembers">0</div>
                    <div class="stat-label">Members Joined</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="spotsRemaining">10,000</div>
                    <div class="stat-label">Free Spots Remaining</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">29</div>
                    <div class="stat-label">Compatibility Dimensions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">AI</div>
                    <div class="stat-label">Powered Matching</div>
                </div>
            </div>

            <!-- How It Works -->
            <div class="how-it-works">
                <h2>How It Works</h2>
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>Chat with AI</h3>
                        <p>Have natural conversations with our AI matchmaker. Share your values, goals, lifestyle, and what matters most to you in a relationship.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>Build Your Profile</h3>
                        <p>Through conversation, we build a comprehensive 29-dimension compatibility profile analyzing everything from faith and family to hobbies and humor.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>Get Matched</h3>
                        <p>Our advanced algorithm finds your most compatible matches based on deep alignment across all 29 dimensions for lasting relationships.</p>
                    </div>
                </div>
            </div>

            <!-- 29 Dimensions Showcase -->
            <div class="dimensions-showcase" id="dimensionsSection">
                <h2>29 Dimensions of Compatibility</h2>
                <p class="dimensions-intro">We analyze compatibility across 29 critical dimensions to ensure deep, lasting connections:</p>
                <div class="dimensions-grid">
                    <div class="dimension-card"><span class="dimension-number">1.</span> Age & Life Stage</div>
                    <div class="dimension-card"><span class="dimension-number">2.</span> Geographic Compatibility</div>
                    <div class="dimension-card"><span class="dimension-number">3.</span> Education & Intellectual Curiosity</div>
                    <div class="dimension-card"><span class="dimension-number">4.</span> Career Ambition</div>
                    <div class="dimension-card"><span class="dimension-number">5.</span> Financial Philosophy</div>
                    <div class="dimension-card"><span class="dimension-number">6.</span> Family of Origin</div>
                    <div class="dimension-card"><span class="dimension-number">7.</span> Children & Parenting</div>
                    <div class="dimension-card"><span class="dimension-number">8.</span> Spirituality & Religion</div>
                    <div class="dimension-card"><span class="dimension-number">9.</span> Political Worldview</div>
                    <div class="dimension-card"><span class="dimension-number">10.</span> Communication Style</div>
                    <div class="dimension-card"><span class="dimension-number">11.</span> Conflict Resolution</div>
                    <div class="dimension-card"><span class="dimension-number">12.</span> Physical Health & Fitness</div>
                    <div class="dimension-card"><span class="dimension-number">13.</span> Mental Health & Self-Care</div>
                    <div class="dimension-card"><span class="dimension-number">14.</span> Social Energy (Introvert/Extrovert)</div>
                    <div class="dimension-card"><span class="dimension-number">15.</span> Domestic Lifestyle</div>
                    <div class="dimension-card"><span class="dimension-number">16.</span> Cleanliness & Organization</div>
                    <div class="dimension-card"><span class="dimension-number">17.</span> Food & Dining Habits</div>
                    <div class="dimension-card"><span class="dimension-number">18.</span> Travel & Adventure</div>
                    <div class="dimension-card"><span class="dimension-number">19.</span> Hobbies & Recreation</div>
                    <div class="dimension-card"><span class="dimension-number">20.</span> Cultural Background</div>
                    <div class="dimension-card"><span class="dimension-number">21.</span> Humor & Playfulness</div>
                    <div class="dimension-card"><span class="dimension-number">22.</span> Affection Expression</div>
                    <div class="dimension-card"><span class="dimension-number">23.</span> Independence vs Togetherness</div>
                    <div class="dimension-card"><span class="dimension-number">24.</span> Decision-Making Style</div>
                    <div class="dimension-card"><span class="dimension-number">25.</span> Time Management</div>
                    <div class="dimension-card"><span class="dimension-number">26.</span> Technology & Digital Habits</div>
                    <div class="dimension-card"><span class="dimension-number">27.</span> Pet Preferences</div>
                    <div class="dimension-card"><span class="dimension-number">28.</span> Substance Use Attitudes</div>
                    <div class="dimension-card"><span class="dimension-number">29.</span> Long-Term Vision & Legacy</div>
                </div>
            </div>

            <!-- Auth Section -->
            <div class="auth-section" id="authSection">
                <div class="auth-forms">
                    <div class="auth-box">
                        <h2>Sign Up</h2>
                        <p style="color: #6c757d; margin-bottom: 15px; font-size: 0.9rem;">
                            <strong>Note:</strong> Password is optional. You can sign up with just your email address (username).
                        </p>
                        <form id="signupForm">
                            <div class="form-group">
                                <label for="signupEmail">Email Address (Username)</label>
                                <input type="email" id="signupEmail" required>
                            </div>
                            <div class="form-group">
                                <label for="signupPassword">Password (Optional)</label>
                                <input type="password" id="signupPassword">
                            </div>
                            <div class="form-group">
                                <label for="signupAge">Age</label>
                                <input type="number" id="signupAge" min="18" required>
                            </div>
                            <button type="submit">Create Account</button>
                        </form>
                        <div id="signupMessage"></div>
                    </div>
                    
                    <div class="auth-box">
                        <h2>Login</h2>
                        <p style="color: #6c757d; margin-bottom: 15px; font-size: 0.9rem;">
                            <strong>Note:</strong> Password is optional. You can login with just your email address (username).
                        </p>
                        <form id="loginForm">
                            <div class="form-group">
                                <label for="loginEmail">Email Address (Username)</label>
                                <input type="email" id="loginEmail" required>
                            </div>
                            <div class="form-group">
                                <label for="loginPassword">Password (Optional)</label>
                                <input type="password" id="loginPassword">
                            </div>
                            <button type="submit">Login</button>
                        </form>
                        <div id="loginMessage"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard View -->
        <div id="dashboardView" class="dashboard-view">
            <div class="dashboard-header">
                <h1 class="welcome-message">Welcome back, <span id="userName">Friend</span>!</h1>
                <div class="membership-badge" id="membershipBadge">Free Lifetime Member #0</div>
                
                <div class="profile-progress">
                    <div class="progress-label">
                        <span>Profile Completion</span>
                        <span id="profilePercentage">0%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="profileProgressBar" style="width: 0%;">0/29 Dimensions</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-cards">
                <div class="dashboard-card" onclick="showView('chat')">
                    <div class="card-icon">üí¨</div>
                    <h3 class="card-title">Continue Chat</h3>
                    <p class="card-description">Chat with your AI matchmaker to build your compatibility profile.</p>
                    <a href="#" class="card-action">Start Conversation ‚Üí</a>
                </div>

                <div class="dashboard-card" onclick="showView('profile')">
                    <div class="card-icon">‚ù§Ô∏è</div>
                    <h3 class="card-title">Profile & Match</h3>
                    <p class="card-description">View your profile and current match based on 29-dimension analysis.</p>
                    <a href="#" class="card-action">View Profile & Match ‚Üí</a>
                </div>
            </div>
        </div>

        <!-- Chat View -->
        <div id="chatView" class="chat-view">
            <div class="chat-container">
                <div class="chat-main">
                    <div class="chat-header">
                        <h3>üí¨ Chat with Your AI Matchmaker</h3>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai">
                            <div>Hi! I'm your AI matchmaker. I'm here to help you find your perfect partner by understanding what matters most to you. Tell me about yourself and what you're looking for in a relationship!</div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" id="chatInput" placeholder="Type your message...">
                        <button onclick="sendMessage()">Send</button>
                    </div>
                </div>

                <div class="chat-sidebar">
                    <div class="sidebar-section">
                        <div class="sidebar-title">üéØ Profile Progress</div>
                        <div class="profile-progress">
                            <div class="progress-label">
                                <span><span id="sidebarDimensionCount">0</span>/29 Dimensions</span>
                                <span id="sidebarPercentage">0%</span>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="sidebarProgressBar" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="sidebar-section" style="flex: 1; display: flex; flex-direction: column;">
                        <div class="sidebar-title">üìÑ Raw Profile JSON</div>
                        <div id="jsonViewer" class="json-viewer">
                            {
  "dimensions": {},
  "status": "building profile..."
}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Match View -->
        <div id="matchView" class="matches-view">
            <div class="matches-header">
                <h2>Your Match</h2>
                <p style="color: #6c757d; margin-top: 10px;">Based on 29-dimension compatibility analysis</p>
                
                <!-- Active/Inactive Toggle -->
                <div class="toggle-container">
                    <span class="toggle-label">Matching Status:</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="matchingActiveToggle" onchange="toggleMatchingStatus()">
                        <span class="toggle-slider"></span>
                    </label>
                    <span id="matchingStatusLabel" class="status-text active">Active</span>
                </div>
            </div>
            <div id="matchContainer" style="max-width: 800px; margin: 0 auto;">
                <!-- Match content will be loaded here -->
                <div style="text-align: center; padding: 40px; color: #2c3e50;">
                    <div style="font-size: 3rem; margin-bottom: 20px;">üîç</div>
                    <h3 style="color: #2c3e50;">No match yet</h3>
                    <p style="color: #34495e;">Complete your profile to get matched!</p>
                    <button class="btn-primary" onclick="showView('chat')" style="margin-top: 20px;">Continue Building Profile</button>
                </div>
            </div>
        </div>

        <!-- Profile View (Combined with Match) -->
        <div id="profileView" class="profile-view">
            <div class="profile-layout">
                <div>
                    <div class="profile-container">
                        <div class="profile-header">
                            <h2>My Profile & Match</h2>
                            <p style="color: #6c757d;">Your 29-dimension compatibility profile</p>
                            
                            <!-- Prominent Active/Inactive Toggle -->
                            <div class="toggle-container" style="margin-top: 20px;">
                                <span class="toggle-label">Matching Status:</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="mainMatchingToggle" onchange="toggleMainMatchingStatus()">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="mainMatchingStatusLabel" class="status-text active">Active</span>
                            </div>
                        </div>
                        
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profileDimCount">0</div>
                                <div class="profile-stat-label">Dimensions Filled</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profileCompletion">0%</div>
                                <div class="profile-stat-label">Completion</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profileConvos">0</div>
                                <div class="profile-stat-label">Conversations</div>
                            </div>
                        </div>
                        
                        <div id="dimensionsSummary" class="dimensions-summary">
                            <!-- Dimension chips will be inserted here -->
                        </div>
                        
                        <button class="btn-primary" onclick="showView('chat')" style="width: 100%; margin-bottom: 20px;">Continue Building Profile</button>
                    </div>
                    
                    <!-- Match Section -->
                    <div id="matchSection" style="margin-top: 20px;">
                        <!-- Match content will be loaded here -->
                    </div>
                </div>
                
                <div class="json-panel">
                    <h3>üìÑ Raw Profile JSON</h3>
                    <div id="profileJsonViewer" class="json-scroll">
                        {
  "loading": "profile data..."
}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'https://rse-api.com:5009';
        let authToken = null;
        let currentUser = null;
        let matchMessagesInterval = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadMemberStats();
        });

        // Load membership statistics
        async function loadMemberStats() {
            try {
                const response = await fetch(`${API_URL}/stats`);
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('totalMembers').textContent = data.total_members.toLocaleString();
                    document.getElementById('spotsRemaining').textContent = data.spots_remaining.toLocaleString();
                }
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Scroll functions
        function scrollToAuth() {
            document.getElementById('authSection').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function scrollToDimensions() {
            document.getElementById('dimensionsSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // View management
        function showView(viewName) {
            // Clear any existing message polling
            if (matchMessagesInterval) {
                clearInterval(matchMessagesInterval);
                matchMessagesInterval = null;
            }
            
            // Hide all views
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('dashboardView').style.display = 'none';
            document.getElementById('chatView').style.display = 'none';
            document.getElementById('matchView').style.display = 'none';
            document.getElementById('profileView').style.display = 'none';

            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));

            // Show selected view
            switch(viewName) {
                case 'dashboard':
                    document.getElementById('dashboardView').style.display = 'block';
                    document.querySelectorAll('.nav-link')[0].classList.add('active');
                    loadDashboard();
                    break;
                case 'chat':
                    document.getElementById('chatView').style.display = 'block';
                    document.querySelectorAll('.nav-link')[1].classList.add('active');
                    loadChatHistory();
                    break;
                case 'profile':
                    document.getElementById('profileView').style.display = 'block';
                    document.querySelectorAll('.nav-link')[2].classList.add('active');
                    loadProfile();
                    break;
            }

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Signup
        document.getElementById('signupForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const age = document.getElementById('signupAge').value;
            
            try {
                const response = await fetch(`${API_URL}/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password, age })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    authToken = data.token;
                    currentUser = data;
                    document.getElementById('signupMessage').innerHTML = 
                        `<div class="success">${data.message}</div>`;
                    
                    // Show dashboard
                    setTimeout(() => {
                        document.getElementById('mainNav').classList.add('active');
                        showView('dashboard');
                    }, 1500);
                } else {
                    document.getElementById('signupMessage').innerHTML = 
                        `<div class="error">${data.error}</div>`;
                }
            } catch (error) {
                document.getElementById('signupMessage').innerHTML = 
                    `<div class="error">Connection error. Please try again.</div>`;
            }
        });

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const response = await fetch(`${API_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    authToken = data.token;
                    currentUser = data;
                    document.getElementById('loginMessage').innerHTML = 
                        `<div class="success">Login successful!</div>`;
                    
                    // Show dashboard
                    setTimeout(() => {
                        document.getElementById('mainNav').classList.add('active');
                        showView('dashboard');
                    }, 1000);
                } else {
                    document.getElementById('loginMessage').innerHTML = 
                        `<div class="error">${data.error}</div>`;
                }
            } catch (error) {
                document.getElementById('loginMessage').innerHTML = 
                    `<div class="error">Connection error. Please try again.</div>`;
            }
        });

        // Load dashboard
        async function loadDashboard() {
            try {
                const response = await fetch(`${API_URL}/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const profile = await response.json();
                
                if (response.ok) {
                    // Update user name
                    document.getElementById('userName').textContent = profile.email.split('@')[0];
                    
                    // Update membership badge
                    if (profile.is_free_member) {
                        document.getElementById('membershipBadge').textContent = 
                            `üíé Free Lifetime Member #${profile.member_number}`;
                    }
                    
                    // Calculate profile completion
                    const dimensionsCount = Object.keys(profile.dimensions || {}).length;
                    const percentage = Math.round((dimensionsCount / 29) * 100);
                    
                    document.getElementById('profilePercentage').textContent = `${percentage}%`;
                    document.getElementById('profileProgressBar').style.width = `${percentage}%`;
                    document.getElementById('profileProgressBar').textContent = `${dimensionsCount}/29 Dimensions`;
                }
            } catch (error) {
                console.error('Error loading dashboard:', error);
            }
        }

        // Load chat history
        async function loadChatHistory() {
            try {
                const response = await fetch(`${API_URL}/chat/history`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                
                if (response.ok && data.messages.length > 0) {
                    const chatMessages = document.getElementById('chatMessages');
                    chatMessages.innerHTML = '';
                    
                    data.messages.forEach(msg => {
                        addMessage(msg.user, 'user', msg.timestamp);
                        addMessage(msg.ai, 'ai', msg.timestamp);
                    });
                }
                
                // Update sidebar
                updateChatSidebar();
            } catch (error) {
                console.error('Error loading chat history:', error);
            }
        }

        // Update chat sidebar with dimension progress
        async function updateChatSidebar() {
            try {
                const response = await fetch(`${API_URL}/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const profile = await response.json();
                
                if (response.ok) {
                    const dimensionsCount = Object.keys(profile.dimensions || {}).length;
                    const percentage = Math.round((dimensionsCount / 29) * 100);
                    
                    document.getElementById('sidebarDimensionCount').textContent = dimensionsCount;
                    document.getElementById('sidebarPercentage').textContent = `${percentage}%`;
                    document.getElementById('sidebarProgressBar').style.width = `${percentage}%`;
                    
                    // Update JSON viewer
                    const jsonViewer = document.getElementById('jsonViewer');
                    if (jsonViewer) {
                        jsonViewer.textContent = JSON.stringify(profile, null, 2);
                    }
                }
            } catch (error) {
                console.error('Error updating sidebar:', error);
            }
        }

        // Send message
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const sendBtn = input.nextElementSibling;
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessage(message, 'user');
            input.value = '';
            
            // Disable input and show spinner
            input.disabled = true;
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<span class="spinner"></span>Sending...';
            
            try {
                const response = await fetch(`${API_URL}/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ message })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    addMessage(data.response, 'ai', data.timestamp);
                    updateChatSidebar();
                } else {
                    addMessage('Sorry, there was an error. Please try again.', 'ai');
                }
            } catch (error) {
                addMessage('Connection error. Please try again.', 'ai');
            } finally {
                // Re-enable input and remove spinner
                input.disabled = false;
                sendBtn.disabled = false;
                sendBtn.innerHTML = 'Send';
                input.focus();
            }
        }

        // Add message to chat
        function addMessage(text, type, timestamp) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const timeStr = timestamp ? new Date(timestamp).toLocaleTimeString() : 'Just now';
            
            messageDiv.innerHTML = `
                <div>${text}</div>
                <div class="message-time">${timeStr}</div>
            `;
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // Enter key to send
        document.getElementById('chatInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Load current match
        async function loadMatch() {
            try {
                const response = await fetch(`${API_URL}/match`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                
                // Update matching toggle status - read from top level of response
                const isActive = data.matching_active !== false;
                const statusLabel = document.getElementById('matchingStatusLabel');
                document.getElementById('matchingActiveToggle').checked = isActive;
                statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                
                const matchContainer = document.getElementById('matchContainer');
                
                if (response.ok && data.match) {
                    const match = data.match;
                    matchContainer.innerHTML = createMatchCard(match, isActive);
                    
                    // Load match messages if both users accepted (mutual acceptance)
                    if (match.mutual_acceptance) {
                        loadMatchMessages();
                    }
                } else {
                    // No match yet
                    const profileComplete = data.profile_complete;
                    const dimensionsCount = data.dimensions_count || 0;
                    
                    matchContainer.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #2c3e50;">
                            <div style="font-size: 3rem; margin-bottom: 20px;">üîç</div>
                            <h3 style="color: #2c3e50; margin-bottom: 15px;">${data.message || 'No match yet'}</h3>
                            ${!profileComplete ? `
                                <p style="color: #34495e; margin-bottom: 20px;">You have ${dimensionsCount}/29 dimensions filled.</p>
                                <button class="btn-primary" onclick="showView('chat')" style="margin-top: 20px;">Continue Building Profile</button>
                            ` : `
                                <p style="color: #34495e;">Your profile is complete! We'll notify you when we find a great match.</p>
                            `}
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading match:', error);
            }
        }

        // Create match card
        function createMatchCard(match, isActive) {
            const score = match.match_score || 0;
            const userAccepted = match.user_accepted || false;
            const matchAccepted = match.match_accepted || false;
            const mutualAcceptance = match.mutual_acceptance || false;
            
            // Match analysis
            const analysis = match.match_analysis || {};
            const reasoning = analysis.reasoning || 'AI-powered compatibility analysis';
            const strengths = analysis.strengths || 'Analyzing compatibility...';
            const concerns = analysis.concerns || 'None identified';
            
            let profileDataHtml = '';
            if (mutualAcceptance && match.full_profile) {
                // Show full profile JSON after mutual acceptance
                const fullProfile = match.full_profile;
                const profileKeys = Object.keys(fullProfile);
                const profileItems = profileKeys.map(key => {
                    const value = typeof fullProfile[key] === 'object' ? JSON.stringify(fullProfile[key]) : fullProfile[key];
                    return `<div style="margin-bottom: 10px;"><strong>${key}:</strong> ${value}</div>`;
                }).join('');
                
                profileDataHtml = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 20px;">
                        <h4 style="color: #764ba2; margin-bottom: 15px;">üìã Match Profile (${profileKeys.length} dimensions)</h4>
                        <div style="max-height: 300px; overflow-y: auto; font-size: 0.9rem;">
                            ${profileItems}
                        </div>
                    </div>
                `;
            } else if (match.preview) {
                // Show limited preview before acceptance
                const preview = match.preview;
                profileDataHtml = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 20px;">
                        <h4 style="color: #764ba2; margin-bottom: 15px;">üë§ Match Preview</h4>
                        <p><strong>Age:</strong> ${preview.age || 'N/A'}</p>
                        <p><strong>Location:</strong> ${preview.location || 'N/A'}</p>
                        <p><strong>Profile Completion:</strong> ${preview.completion_percentage || 0}%</p>
                        <p style="color: #6c757d; font-style: italic; margin-top: 10px;">
                            Accept the match to see full profile details and start chatting!
                        </p>
                    </div>
                `;
            }
            
            let actionsHtml = '';
            if (!userAccepted) {
                // Show accept/decline buttons
                actionsHtml = `
                    <div class="match-actions" style="margin-top: 20px;">
                        <p style="color: #6c757d; margin-bottom: 15px; text-align: center;">
                            Review this match and decide if you'd like to connect
                        </p>
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button class="btn-primary" onclick="acceptMatch()" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                                ‚úì Accept Match
                            </button>
                            <button class="btn-reject" onclick="rejectMatch()">
                                ‚úó Decline Match
                            </button>
                        </div>
                    </div>
                `;
            } else if (!mutualAcceptance) {
                // User accepted, waiting for match to accept
                actionsHtml = `
                    <div style="background: #d1ecf1; padding: 20px; border-radius: 8px; margin-top: 20px; text-align: center;">
                        <h4 style="color: #0c5460; margin-bottom: 10px;">‚è≥ Waiting for Match Response</h4>
                        <p style="color: #0c5460;">You've accepted this match! Waiting for them to accept too.</p>
                        <p style="color: #0c5460; font-size: 0.9rem; margin-top: 10px;">
                            Chat will be enabled once both of you accept.
                        </p>
                    </div>
                `;
            } else {
                // Both accepted - show chat interface
                actionsHtml = `
                    <div class="match-chat-container" style="margin-top: 20px;">
                        <h3 style="margin-bottom: 15px; color: #764ba2;">üí¨ Private Chat</h3>
                        <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                            <p style="color: #155724; font-weight: 600;">üéâ Match Accepted! You can now chat privately.</p>
                        </div>
                        <div class="match-chat-messages" id="matchChatMessages">
                            <div style="text-align: center; color: #6c757d; padding: 20px;">
                                Start a conversation!
                            </div>
                        </div>
                        <div class="match-chat-input-area">
                            <input type="text" id="matchChatInput" placeholder="Type your message...">
                            <button onclick="sendMatchMessage()">Send</button>
                        </div>
                    </div>
                `;
            }
            
            return `
                <div class="match-card">
                    <div class="match-score">
                        <div class="compatibility-circle">${score}%</div>
                        <div style="color: #6c757d;">Compatibility</div>
                    </div>
                    <div class="match-info">
                        <h3>Your Match</h3>
                        <p style="color: #6c757d;">Age: ${match.age || 'N/A'}</p>
                        <p style="color: #6c757d; margin-top: 10px;">Matched on ${match.matched_at ? new Date(match.matched_at).toLocaleDateString() : 'recently'}</p>
                        ${userAccepted ? '<p style="color: #28a745; margin-top: 5px;">‚úì You accepted</p>' : ''}
                        ${matchAccepted ? '<p style="color: #28a745; margin-top: 5px;">‚úì Match accepted</p>' : ''}
                    </div>
                    <div style="background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%); padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <h4 style="color: #764ba2; margin-bottom: 10px;">üîç Compatibility Analysis</h4>
                        <p style="color: #2c3e50; margin-bottom: 8px;"><strong>Reasoning:</strong> ${reasoning}</p>
                        <p style="color: #2c3e50; margin-bottom: 8px;"><strong>Strengths:</strong> ${strengths}</p>
                        <p style="color: #2c3e50;"><strong>Considerations:</strong> ${concerns}</p>
                    </div>
                    ${profileDataHtml}
                    ${actionsHtml}
                </div>
            `;
        }

        // Toggle matching active/inactive
        async function toggleMatchingStatus() {
            const isActive = document.getElementById('matchingActiveToggle').checked;
            const statusLabel = document.getElementById('matchingStatusLabel');
            
            try {
                const response = await fetch(`${API_URL}/match/toggle`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ active: isActive })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                    statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    // Reload match view to show appropriate UI
                    loadMatch();
                } else {
                    alert(data.error || 'Failed to update status');
                    // Revert toggle
                    document.getElementById('matchingActiveToggle').checked = !isActive;
                }
            } catch (error) {
                console.error('Error toggling status:', error);
                alert('Connection error. Please try again.');
                document.getElementById('matchingActiveToggle').checked = !isActive;
            }
        }

        // Accept current match
        async function acceptMatch() {
            if (!confirm('Accept this match? This will allow both of you to chat once they also accept.')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/match/accept`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    alert(data.message || 'Match accepted successfully!');
                    loadMatch();
                } else {
                    alert(data.error || 'Failed to accept match');
                }
            } catch (error) {
                console.error('Error accepting match:', error);
                alert('Connection error. Please try again.');
            }
        }

        // Reject current match
        async function rejectMatch() {
            if (!confirm('Decline this match? You will be matched with someone new in the next cycle.')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/match/reject`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    alert(data.message || 'Match declined successfully');
                    loadMatch();
                } else {
                    alert(data.error || 'Failed to decline match');
                }
            } catch (error) {
                console.error('Error declining match:', error);
                alert('Connection error. Please try again.');
            }
        }

        // Send message to match
        async function sendMatchMessage() {
            const input = document.getElementById('matchChatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            try {
                const response = await fetch(`${API_URL}/match/messages`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ message })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    input.value = '';
                    // Add message to UI immediately
                    addMatchMessage(message, 'sent', data.timestamp);
                } else {
                    alert(data.error || 'Failed to send message');
                }
            } catch (error) {
                console.error('Error sending message:', error);
                alert('Connection error. Please try again.');
            }
        }

        // Load match messages
        async function loadMatchMessages() {
            try {
                // Get current user profile to determine user_id
                const profileResponse = await fetch(`${API_URL}/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const profile = await profileResponse.json();
                const myUserId = profile.user_id;
                
                const response = await fetch(`${API_URL}/match/messages`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                
                if (response.ok && data.messages.length > 0) {
                    const messagesDiv = document.getElementById('matchChatMessages');
                    messagesDiv.innerHTML = '';
                    
                    data.messages.forEach(msg => {
                        const type = msg.from === myUserId ? 'sent' : 'received';
                        addMatchMessage(msg.message, type, msg.timestamp);
                    });
                }
            } catch (error) {
                console.error('Error loading match messages:', error);
            }
        }

        // Add match message to UI
        function addMatchMessage(text, type, timestamp) {
            const messagesDiv = document.getElementById('matchChatMessages');
            if (!messagesDiv) return;
            
            // Clear placeholder if exists
            if (messagesDiv.querySelector('[style*="text-align: center"]')) {
                messagesDiv.innerHTML = '';
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `match-message ${type}`;
            
            const timeStr = timestamp ? new Date(timestamp).toLocaleTimeString() : 'Just now';
            
            messageDiv.innerHTML = `
                <div>${text}</div>
                <div style="font-size: 0.75rem; opacity: 0.7; margin-top: 5px;">${timeStr}</div>
            `;
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // Enter key to send match message
        document.addEventListener('DOMContentLoaded', () => {
            document.addEventListener('keypress', (e) => {
                if (e.target.id === 'matchChatInput' && e.key === 'Enter') {
                    sendMatchMessage();
                }
            });
        });

        // Load profile (combined with match)
        async function loadProfile() {
            try {
                // Load profile data
                const response = await fetch(`${API_URL}/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const profile = await response.json();
                
                if (response.ok) {
                    // Update stats
                    const dimensionsCount = Object.keys(profile.dimensions || {}).length;
                    const percentage = Math.round((dimensionsCount / 29) * 100);
                    
                    document.getElementById('profileDimCount').textContent = dimensionsCount;
                    document.getElementById('profileCompletion').textContent = `${percentage}%`;
                    document.getElementById('profileConvos').textContent = profile.conversation_count || 0;
                    
                    // Set main matching toggle state
                    const isActive = profile.matching_active !== false;
                    const mainToggle = document.getElementById('mainMatchingToggle');
                    const mainStatusLabel = document.getElementById('mainMatchingStatusLabel');
                    if (mainToggle) {
                        mainToggle.checked = isActive;
                        mainStatusLabel.textContent = isActive ? 'Active' : 'Inactive';
                        mainStatusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    }
                    
                    // Update dimension chips
                    const dimensionsSummary = document.getElementById('dimensionsSummary');
                    if (dimensionsCount > 0) {
                        dimensionsSummary.innerHTML = Object.keys(profile.dimensions)
                            .map(key => `<div class="dimension-chip">${key}</div>`)
                            .join('');
                    } else {
                        dimensionsSummary.innerHTML = '<div style="text-align: center; color: #6c757d; padding: 20px;">No dimensions filled yet. Start chatting to build your profile!</div>';
                    }
                    
                    // Update JSON viewer
                    const jsonViewer = document.getElementById('profileJsonViewer');
                    jsonViewer.textContent = JSON.stringify(profile, null, 2);
                    
                    // Load match data in the match section
                    await loadMatchInProfile();
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }
        
        // Load match data for profile view
        async function loadMatchInProfile() {
            try {
                const response = await fetch(`${API_URL}/match`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                const matchSection = document.getElementById('matchSection');
                
                if (response.ok && data.match) {
                    const match = data.match;
                    const isActive = data.matching_active !== false;
                    
                    matchSection.innerHTML = `
                        <div class="matches-header">
                            <h2>Your Match</h2>
                            <p style="color: #6c757d; margin-top: 10px;">Based on 29-dimension compatibility analysis</p>
                            
                            <div class="toggle-container">
                                <span class="toggle-label">Matching Status:</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="profileMatchToggle" ${isActive ? 'checked' : ''} onchange="toggleMatchingStatusFromProfile()">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="profileMatchStatusLabel" class="status-text ${isActive ? 'active' : 'inactive'}">${isActive ? 'Active' : 'Inactive'}</span>
                            </div>
                        </div>
                        
                        ${createMatchCard(match, isActive)}
                    `;
                } else {
                    matchSection.innerHTML = `
                        <div class="matches-header">
                            <h2>Your Match</h2>
                            <p style="color: #6c757d; margin-top: 10px;">No match yet. Complete your profile to get matched!</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading match:', error);
            }
        }
        
        // Toggle main matching status from profile view
        async function toggleMainMatchingStatus() {
            const isActive = document.getElementById('mainMatchingToggle').checked;
            const statusLabel = document.getElementById('mainMatchingStatusLabel');
            
            try {
                const response = await fetch(`${API_URL}/match/toggle`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ active: isActive })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                    statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    loadMatchInProfile();
                } else {
                    alert(data.error || 'Failed to update status');
                    document.getElementById('mainMatchingToggle').checked = !isActive;
                }
            } catch (error) {
                console.error('Error toggling status:', error);
                alert('Connection error. Please try again.');
                document.getElementById('mainMatchingToggle').checked = !isActive;
            }
        }
        
        // Toggle matching status from profile view (secondary toggle in match section)
        async function toggleMatchingStatusFromProfile() {
            const isActive = document.getElementById('profileMatchToggle').checked;
            const statusLabel = document.getElementById('profileMatchStatusLabel');
            
            try {
                const response = await fetch(`${API_URL}/match/toggle`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ active: isActive })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    statusLabel.textContent = isActive ? 'Active' : 'Inactive';
                    statusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    // Also update main toggle
                    const mainToggle = document.getElementById('mainMatchingToggle');
                    const mainStatusLabel = document.getElementById('mainMatchingStatusLabel');
                    if (mainToggle) {
                        mainToggle.checked = isActive;
                        mainStatusLabel.textContent = isActive ? 'Active' : 'Inactive';
                        mainStatusLabel.className = isActive ? 'status-text active' : 'status-text inactive';
                    }
                    loadMatchInProfile();
                } else {
                    alert(data.error || 'Failed to update status');
                    document.getElementById('profileMatchToggle').checked = !isActive;
                }
            } catch (error) {
                console.error('Error toggling status:', error);
                alert('Connection error. Please try again.');
                document.getElementById('profileMatchToggle').checked = !isActive;
            }
        }

        // Logout
        function logout() {
            // Clear any intervals
            if (matchMessagesInterval) {
                clearInterval(matchMessagesInterval);
                matchMessagesInterval = null;
            }
            
            authToken = null;
            currentUser = null;
            document.getElementById('mainNav').classList.remove('active');
            document.getElementById('landingPage').style.display = 'block';
            document.getElementById('dashboardView').style.display = 'none';
            document.getElementById('chatView').style.display = 'none';
            document.getElementById('matchView').style.display = 'none';
            document.getElementById('profileView').style.display = 'none';
            
            // Clear forms
            document.getElementById('signupForm').reset();
            document.getElementById('loginForm').reset();
            document.getElementById('signupMessage').innerHTML = '';
            document.getElementById('loginMessage').innerHTML = '';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
